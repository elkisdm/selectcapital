<!doctype html>
<html lang="es" data-theme="light" data-theme-transition>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>VIVA MAR√çN | Inversi√≥n en Santiago Centro ‚Äî Select Capital</title>
    <meta name="description" content="Invierte en VIVA MAR√çN en Santiago Centro desde UF 2.350. Pie 10% en 48 cuotas, 15% descuento lanzamiento. Asesor√≠a sin costo." />
    <meta name="theme-color" content="#F6F8FC" />
    <link rel="icon" href="/images/icono.png" />
    
    <!-- DNS Prefetch para recursos externos -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
    <link rel="dns-prefetch" href="https://fonts.gstatic.com" />
    <link rel="dns-prefetch" href="https://challenges.cloudflare.com" />
    
    <!-- Preconnect para recursos cr√≠ticos -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    
    <!-- Preload de fuente cr√≠tica -->
    <link rel="preload" href="https://fonts.gstatic.com/s/inter/v13/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfAZ9hiJ-Ek-_EeA.woff2" as="font" type="font/woff2" crossorigin />
    
    <!-- Fuentes con font-display swap -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    
    <!-- CSS cr√≠tico -->
    <link rel="stylesheet" href="/lenguaje visual/theme/select-capital-theme.min.css?v=66e592e976" />
    <link rel="stylesheet" href="/lenguaje visual/forms/sc-forms.css?v=20250118" />
    <link rel="stylesheet" href="/landing/proyecto-inmobiliario/viva-marin-styles.css?v=20250118-4" />
  </head>
  <body>
    <button class="theme-toggle" type="button" data-theme-toggle aria-label="Cambiar tema">
      <span data-theme-icon>üåô</span>
    </button>

    <nav class="sticky-nav" id="sticky-nav">
      <div class="sticky-nav-content">
        <img src="/images/logo_blanco.png" alt="Select Capital" class="sticky-nav-logo" />
        <div class="sticky-nav-links">
          <a href="#tipologias">Tipolog√≠as</a>
          <a href="#ubicacion">Ubicaci√≥n</a>
          <a href="#contacto">Cotizar</a>
        </div>
        <button class="sticky-nav-theme-toggle" type="button" data-theme-toggle-nav aria-label="Cambiar tema">
          <span data-theme-icon-nav>üåô</span>
        </button>
      </div>
    </nav>

    <div class="page">
      <!-- HEADER / HERO -->
      <header class="header">
        <div class="header-logo">
          <img src="/images/logo_negro.png" alt="Select Capital" class="logo-light" />
          <img src="/images/logo_blanco.png" alt="Select Capital" class="logo-dark" style="display: none;" />
        </div>

        <div class="header-main">
          <div class="hero-content-wrapper">
            <div class="hero-text-content">
              <h1 class="headline">
                Invierte en <span>VIVA MAR√çN</span> en Santiago Centro<br />
                desde UF 2.350
              </h1>
              <p class="subheadline">
                Edificio de solo 162 departamentos en esquina Mar√≠n con Lira, pensado para quienes quieren vivir o invertir en el coraz√≥n de Santiago Centro sin perder tranquilidad.
              </p>

              <!-- Hero Image - M√≥vil: despu√©s del t√≠tulo y subt√≠tulo -->
              <div class="hero-media-mobile">
                <div class="hero-tagline">VIVA MAR√çN ‚Äî Santiago Centro</div>
                <div class="hero-title">Esquina Mar√≠n con Lira ¬∑ 162 departamentos</div>
                <div class="hero-image-placeholder">
                  <img src="/images/viva marin/fachada.png" alt="Fachada principal VIVA MAR√çN" loading="eager" fetchpriority="high" width="600" height="800" decoding="async" />
                </div>
            </div>

              <div class="header-grid">
                <div class="pill">
                  <span>Promoci√≥n lanzamiento</span>
                  <strong>15% de descuento</strong>
                </div>
                <div class="pill">
                  <span>Pie 10%</span>
                  <strong>En hasta 48 cuotas</strong>
                </div>
                <div class="pill">
                  <span>Tipolog√≠as</span>
                  <strong>Estudio ¬∑ 1D ¬∑ 2D</strong>
                </div>
                <div class="pill">
                  <span>Entrega estimada</span>
                  <strong>Mediados 2028</strong>
                </div>
              </div>
            </div>

            <div class="hero-cta-section">
              <button type="button" class="hero-cta-primary" data-action="scroll-form">
                <span class="btn-primary-icon">üìÑ</span>
                <span>Quiero mi propuesta</span>
              </button>
            </div>
            </div>

          <!-- Hero Image - Desktop: lado derecho -->
          <div class="hero-media">
            <div class="hero-tagline">VIVA MAR√çN ‚Äî Santiago Centro</div>
            <div class="hero-title">Esquina Mar√≠n con Lira ¬∑ 162 departamentos</div>
            <div class="hero-image-placeholder">
              <img src="/images/viva marin/fachada.png" alt="Fachada principal VIVA MAR√çN" loading="eager" fetchpriority="high" width="600" height="800" decoding="async" />
              </div>
              </div>
            </div>
      </header>

      <!-- DATOS CLAVE / DESCRIPCI√ìN -->
      <section class="section" id="datos-clave">
        <div class="section-header">
          <h2 class="section-title">Datos clave del proyecto</h2>
          <p class="section-kicker">Resumen r√°pido: precio de entrada, etapas y contexto</p>
            </div>

        <div class="card" style="margin-bottom: 16px;">
          <div class="card-grid">
            <div>
              <div class="metric-label">Desde</div>
              <div class="metric-value">UF 2.350</div>
              <div class="metric-hint">Valores referenciales</div>
            </div>
            <div>
              <div class="metric-label">Tipolog√≠as</div>
              <div class="metric-value">Estudio ¬∑ 1D ¬∑ 2D</div>
              <div class="metric-hint">162 departamentos</div>
        </div>
            <div>
              <div class="metric-label">Pie</div>
              <div class="metric-value">10% en 48 cuotas</div>
              <div class="metric-hint">Promoci√≥n lanzamiento</div>
              </div>
            <div>
              <div class="metric-label">Entrega</div>
              <div class="metric-value">Mediados 2028</div>
              <div class="metric-hint">Etapa verde</div>
            </div>
          </div>
        </div>

        <div class="description-showcase">
          <div class="description-card">
            <div class="description-icon">üìç</div>
            <div class="description-content">
              <h3 class="description-title">Ubicaci√≥n estrat√©gica</h3>
              <p class="description-text">
                En la esquina de <strong>Mar√≠n con Lira</strong>, en pleno coraz√≥n de Santiago Centro, se levanta <strong>VIVA Mar√≠n</strong>: un edificio de solo 162 departamentos ‚Äî 1 y 2 dormitorios ‚Äî pensado para quienes buscan conectar con la ciudad sin sacrificar tranquilidad.
              </p>
              </div>
            </div>

          <div class="description-features">
            <div class="feature-item">
              <span class="feature-icon">üöá</span>
              <span class="feature-text">A pasos de metro</span>
              </div>
            <div class="feature-item">
              <span class="feature-icon">üè•</span>
              <span class="feature-text">Hospitales cercanos</span>
            </div>
            <div class="feature-item">
              <span class="feature-icon">üéì</span>
              <span class="feature-text">Universidades</span>
          </div>
            <div class="feature-item">
              <span class="feature-icon">üõí</span>
              <span class="feature-text">Comercio urbano</span>
        </div>
          </div>

          <div class="description-highlight">
            <div class="highlight-badge">üöÄ Futura L√≠nea 9</div>
            <p class="highlight-text">
              La futura <strong>L√≠nea 9 del Metro de Santiago</strong> se trazar√° por la Avenida Santa Rosa, lo que incrementa la expectativa de <strong>valorizaci√≥n del sector</strong> en el mediano plazo.
            </p>
          </div>
        </div>
      </section>

      <!-- EXPERIENCIA / AMENITIES -->
      <section class="section" id="experiencia">
        <div class="section-header">
          <h2 class="section-title">Experiencia del proyecto</h2>
          <p class="section-kicker">Espacios comunes, amenities y zonas pensadas para el d√≠a a d√≠a</p>
              </div>

        <div class="amenities-grid">
          <article class="amenity-card">
            <div class="amenity-media">
              <img src="/images/viva marin/fachada.png" alt="Fachada principal VIVA MAR√çN" loading="lazy" width="400" height="533" decoding="async" />
            </div>
            <div class="amenity-title">Fachada principal</div>
            <div class="amenity-caption">Arquitectura moderna que se integra al tejido urbano de Santiago Centro.</div>
          </article>

          <article class="amenity-card">
            <div class="amenity-media">
              <img src="/images/viva marin/halldepto.png" alt="Living VIVA MAR√çN" loading="lazy" width="400" height="533" decoding="async" />
              </div>
            <div class="amenity-title">Living</div>
            <div class="amenity-caption">Espacios amplios y luminosos para disfrutar en familia.</div>
          </article>

          <article class="amenity-card">
            <div class="amenity-media">
              <img src="/images/viva marin/cocina.png" alt="Cocina VIVA MAR√çN" loading="lazy" width="400" height="533" decoding="async" />
            </div>
            <div class="amenity-title">Cocina</div>
            <div class="amenity-caption">Dise√±o moderno y funcional con equipamiento de primera calidad.</div>
          </article>

          <article class="amenity-card">
            <div class="amenity-media">
              <img src="/images/viva marin/dormitorio.png" alt="Habitaci√≥n VIVA MAR√çN" loading="lazy" width="400" height="533" decoding="async" />
          </div>
            <div class="amenity-title">Habitaci√≥n</div>
            <div class="amenity-caption">Dormitorios amplios y confortables para tu descanso.</div>
          </article>
        </div>
      </section>

      <!-- TIPOLOG√çAS Y PLANOS -->
      <section class="section" id="tipologias">
        <div class="section-header">
          <h2 class="section-title">Tipolog√≠as disponibles</h2>
          <p class="section-kicker">Conoce los departamentos y sus superficies</p>
          </div>

        <div class="typologies-grid">
          <!-- Studio -->
          <article class="typology-card">
            <div class="typology-image-wrapper" data-lightbox="true" data-image="/images/viva marin/render_studio.png" data-title="Studio - DEPTO 310 AL 910">
              <img src="/images/viva marin/render_studio.png" alt="Plano Studio VIVA MAR√çN" loading="lazy" decoding="async" />
        </div>
            <div class="typology-content">
              <div class="typology-header">
                <h3 class="typology-title">Studio</h3>
                <span class="typology-badge">DEPTO 310 AL 910</span>
              </div>
              <div class="typology-specs">
                <div class="spec-item">
                  <span class="spec-label">Superficie Interior</span>
                  <span class="spec-value">20.62 m¬≤</span>
                </div>
                <div class="spec-item">
                  <span class="spec-label">Sup. Terraza (100%)</span>
                  <span class="spec-value">0.00 m¬≤</span>
                </div>
                <div class="spec-item spec-total">
                  <span class="spec-label">SUP. TOTAL</span>
                  <span class="spec-value">20.62 m¬≤</span>
                </div>
              </div>
            </div>
          </article>

          <!-- 1 Dormitorio -->
          <article class="typology-card">
            <div class="typology-image-wrapper" data-lightbox="true" data-image="/images/viva marin/render_1d1b.png" data-title="1 Dormitorio - DEPTO 308 AL 908">
              <img src="/images/viva marin/render_1d1b.png" alt="Plano 1 Dormitorio VIVA MAR√çN" loading="lazy" decoding="async" />
          </div>
            <div class="typology-content">
              <div class="typology-header">
                <h3 class="typology-title">1 Dormitorio</h3>
                <span class="typology-badge">DEPTO 308 AL 908</span>
        </div>
              <div class="typology-specs">
                <div class="spec-item">
                  <span class="spec-label">Superficie Interior</span>
                  <span class="spec-value">29.25 m¬≤</span>
                </div>
                <div class="spec-item">
                  <span class="spec-label">Sup. Terraza (100%)</span>
                  <span class="spec-value">2.00 m¬≤</span>
                </div>
                <div class="spec-item spec-total">
                  <span class="spec-label">SUP. TOTAL</span>
                  <span class="spec-value">31.25 m¬≤</span>
                </div>
              </div>
            </div>
          </article>

          <!-- 2 Dormitorios -->
          <article class="typology-card">
            <div class="typology-image-wrapper" data-lightbox="true" data-image="/images/viva marin/render_2d2b.png" data-title="2 Dormitorios - DEPTO 202 AL 902">
              <img src="/images/viva marin/render_2d2b.png" alt="Plano 2 Dormitorios VIVA MAR√çN" loading="lazy" decoding="async" />
            </div>
            <div class="typology-content">
              <div class="typology-header">
                <h3 class="typology-title">2 Dormitorios</h3>
                <span class="typology-badge">DEPTO 202 AL 902</span>
              </div>
              <div class="typology-specs">
                <div class="spec-item">
                  <span class="spec-label">Superficie Interior</span>
                  <span class="spec-value">49.40 m¬≤</span>
            </div>
                <div class="spec-item">
                  <span class="spec-label">Sup. Terraza (100%)</span>
                  <span class="spec-value">2.03 m¬≤</span>
          </div>
                <div class="spec-item spec-total">
                  <span class="spec-label">SUP. TOTAL</span>
                  <span class="spec-value">51.43 m¬≤</span>
                </div>
              </div>
            </div>
          </article>
        </div>
      </section>

      <!-- UBICACI√ìN Y CONECTIVIDAD -->
      <section class="section" id="ubicacion">
        <div class="section-header">
          <h2 class="section-title">Ubicaci√≥n y conectividad</h2>
          <p class="section-kicker">Todo lo que necesitas, a minutos caminando</p>
          </div>

        <div class="location-grid">
          <div>
            <ul class="list">
              <li>
                <div class="list-icon">üéì</div>
                <div class="list-content">
                  <span>Educaci√≥n</span>
                  <strong>Universidad Cat√≥lica ¬∑ 5 min</strong>
        </div>
              </li>
              <li>
                <div class="list-icon">üõí</div>
                <div class="list-content">
                  <span>Comercio</span>
                  <strong>Strip Center Portugal ¬∑ 6 min</strong>
            </div>
              </li>
              <li>
                <div class="list-icon">üöá</div>
                <div class="list-content">
                  <span>Metro</span>
                  <strong>Santa Luc√≠a ¬∑ 10 min</strong>
          </div>
              </li>
              <li>
                <div class="list-icon">üè•</div>
                <div class="list-content">
                  <span>Salud</span>
                  <strong>Hospital del Salvador ¬∑ 6 min</strong>
        </div>
              </li>
            </ul>

            <p class="text-block" style="margin-top: 16px;">
              Est√°s en el <strong>centro hist√≥rico de Santiago</strong>, una zona con alta plusval√≠a por su conectividad, servicios y vida urbana. Ideal para renta de largo plazo y para profesionales que buscan cercan√≠a con todo.
              </p>
          </div>

          <div class="map-card">
            <div id="map" style="width: 100%; height: 400px; border-radius: var(--lp-radius-lg);"></div>
            <div class="map-overlay">
              <a href="https://www.google.com/maps/search/?api=1&query=Mar√≠n+Lira+Santiago+Centro" target="_blank" rel="noopener" class="map-link">
                <span>üìç Esquina Mar√≠n con Lira, Santiago Centro</span>
                <span style="font-size: 10px; opacity: 0.8;">Abrir en Google Maps</span>
              </a>
            </div>
          </div>
        </div>
      </section>

      <!-- POR QU√â INVERTIR AHORA -->
      <section class="section" id="por-que-invertir">
        <div class="section-header">
          <h2 class="section-title">¬øPor qu√© invertir ahora?</h2>
          <p class="section-kicker">Contexto de mercado y oportunidad concreta en VIVA MAR√çN</p>
          </div>

        <div class="why-invest-grid">
          <div class="why-invest-card">
            <div class="why-invest-icon">üìâ</div>
            <h3 class="why-invest-title">Tasas en baja</h3>
            <p class="why-invest-text">
              Las <strong>tasas de inter√©s hipotecarias han comenzado a bajar</strong>, lo que mejora la accesibilidad al cr√©dito y reduce el costo total del financiamiento.
            </p>
          </div>

          <div class="why-invest-card">
            <div class="why-invest-icon">üìà</div>
            <h3 class="why-invest-title">Alta demanda</h3>
            <p class="why-invest-text">
              Est√°s en una zona con <strong>alta demanda de arriendo y oferta moderada</strong>, lo que proyecta buena estabilidad de ocupaci√≥n y valorizaci√≥n futura.
            </p>
          </div>

          <div class="why-invest-card">
            <div class="why-invest-icon">üå±</div>
            <h3 class="why-invest-title">Etapa verde</h3>
            <p class="why-invest-text">
              VIVA MAR√çN se encuentra en <strong>etapa verde</strong>: puedes pagar el pie en cuotas y capturar plusval√≠a desde la construcci√≥n.
            </p>
          </div>
            </div>

        <div class="why-invest-highlights">
          <div class="highlight-pill">
            <span class="highlight-pill-icon">üìâ</span>
            <span>Baja gradual de tasas hipotecarias</span>
                  </div>
          <div class="highlight-pill">
            <span class="highlight-pill-icon">üìà</span>
            <span>Alta demanda de arriendo en Santiago Centro</span>
                  </div>
          <div class="highlight-pill">
            <span class="highlight-pill-icon">üå±</span>
            <span>Etapa verde: pie en cuotas</span>
                  </div>
          <div class="highlight-pill">
            <span class="highlight-pill-icon">üöá</span>
            <span>Proyecci√≥n positiva por futura L√≠nea 9</span>
          </div>
        </div>
      </section>

      <!-- PROCESO DE INVERSI√ìN -->
      <section class="section" id="proceso">
        <div class="section-header">
          <h2 class="section-title">Proceso de inversi√≥n</h2>
          <p class="section-kicker">Acompa√±amiento desde el diagn√≥stico hasta la firma de promesa</p>
              </div>

        <div class="steps-grid">
          <article class="step-card">
            <div class="step-index">1</div>
            <div class="step-title">An√°lisis financiero</div>
            <p class="step-text">
              Revisamos tu documentaci√≥n y dise√±amos una propuesta adaptada tanto a tu perfil de inversionista como a tu situaci√≥n financiera actual.
            </p>
          </article>

          <article class="step-card">
            <div class="step-index">2</div>
            <div class="step-title">Preaprobaci√≥n bancaria</div>
            <p class="step-text">
              Coordinamos con nuestros ejecutivos para obtener una o m√°s preaprobaciones de cr√©dito, dejando tu financiamiento encaminado antes de reservar.
            </p>
          </article>

          <article class="step-card">
            <div class="step-index">3</div>
            <div class="step-title">Reserva de la unidad</div>
            <p class="step-text">
              Realizas la reserva para asegurar la unidad seleccionada mientras ultimamos detalles de la promesa de compraventa.
            </p>
          </article>

          <article class="step-card">
            <div class="step-index">4</div>
            <div class="step-title">Firma de promesa</div>
            <p class="step-text">
              Firmas la promesa de compraventa, que fija precio, plazos y condiciones, entreg√°ndote seguridad jur√≠dica antes de la escritura final.
            </p>
          </article>
            </div>
      </section>

      <!-- PREGUNTAS FRECUENTES -->
      <section class="section" id="faq">
        <div class="section-header">
          <h2 class="section-title">Preguntas frecuentes</h2>
          <p class="section-kicker">Resolvemos las dudas m√°s comunes antes de invertir</p>
                  </div>

        <div class="faq-grid">
          <div class="faq-item">
            <div class="faq-q">
              <span class="faq-icon">üí∞</span>
              <span>¬øC√≥mo se divide el pie 10%?</span>
                  </div>
            <div class="faq-a">El pie se divide en cuotas, permiti√©ndote entrar al proyecto con menor esfuerzo inicial. Detalle exacto seg√∫n condiciones vigentes al momento de la reserva.</div>
                  </div>

          <div class="faq-item">
            <div class="faq-q">
              <span class="faq-icon">üìã</span>
              <span>¬øQu√© necesito para promesar?</span>
                </div>
            <div class="faq-a">Contar con una preaprobaci√≥n bancaria vigente y cumplir con la documentaci√≥n solicitada por la inmobiliaria y el banco.</div>
              </div>

          <div class="faq-item">
            <div class="faq-q">
              <span class="faq-icon">üìÖ</span>
              <span>¬øCu√°ndo se entrega el proyecto?</span>
                </div>
            <div class="faq-a">La entrega estimada es a mediados de 2028, sujeta al avance de la obra y permisos correspondientes.</div>
                </div>

          <div class="faq-item">
            <div class="faq-q">
              <span class="faq-icon">üöó</span>
              <span>¬øHay estacionamientos y bodegas?</span>
                </div>
            <div class="faq-a">S√≠, hay opciones de estacionamientos y bodegas sujetos a disponibilidad y valores vigentes al momento de la reserva.</div>
                </div>

          <div class="faq-item">
            <div class="faq-q">
              <span class="faq-icon">üéÅ</span>
              <span>¬øQu√© incluye la promoci√≥n?</span>
            </div>
            <div class="faq-a">Promoci√≥n de lanzamiento con un 15% de descuento sobre el valor de lista, v√°lida para unidades y plazos definidos por el desarrollador.</div>
                </div>

          <div class="faq-item">
            <div class="faq-q">
              <span class="faq-icon">üí≥</span>
              <span>¬øHay gastos adicionales?</span>
                </div>
            <div class="faq-a">S√≠, los habituales gastos operacionales, notariales y seguros al momento de la escrituraci√≥n del cr√©dito hipotecario.</div>
              </div>
        </div>
      </section>

      <!-- FORMULARIO / LEAD FORM -->
      <section class="section" id="contacto">
        <div class="section-header">
          <h2 class="section-title">Recibe tu propuesta</h2>
          <p class="section-kicker">D√©janos tus datos y te enviamos n√∫meros claros para tu caso</p>
                </div>

        <div class="form-card">
          <p class="text-block" style="margin-bottom: 16px;">
            Te enviaremos una propuesta con valor estimado de la unidad, pie, monto de dividendo y renta proyectada seg√∫n tu perfil. Sin costo y sin compromiso.
          </p>

          <form class="form" action="/submit.php" method="post">
            <div class="form-grid">
              <div class="field">
                <label for="nombre">
                  <span>Nombre completo</span>
                </label>
                <input id="nombre" name="nombre" type="text" placeholder="Ej: Ana P√©rez" required />
                </div>

              <div class="field">
                <label for="rut">
                  <span>RUT</span>
                </label>
                <input id="rut" name="rut" type="text" placeholder="Ej: 12.345.678-9" required />
                </div>

              <div class="field">
                <label for="telefono">
                  <span>Tel√©fono WhatsApp</span>
                </label>
                <input id="telefono" name="telefono" type="tel" placeholder="+56 9 ..." required />
                  </div>

              <div class="field">
                <label for="correo">
                  <span>Correo electr√≥nico</span>
                </label>
                <input id="correo" name="correo" type="email" placeholder="tu@correo.cl" required />
                </div>

              <div class="field">
                <label for="objetivo">
                  <span>Objetivo</span>
                </label>
                <select id="objetivo" name="objetivo" required>
                  <option value="">Selecciona una opci√≥n</option>
                  <option value="invertir">Invertir para renta</option>
                  <option value="vivir">Comprar para vivir</option>
                  <option value="no-se">A√∫n no lo tengo claro</option>
                  </select>
                </div>

              <div class="field">
                <label for="renta">
                  <span>Renta l√≠quida mensual (CLP)</span>
                </label>
                <input id="renta" name="renta" type="text" placeholder="Promedio mensual" required />
              </div>

              <div class="field">
                <label for="ahorro">
                  <span>Ahorros disponibles para pie</span>
                </label>
                <input id="ahorro" name="ahorro" type="text" placeholder="Monto aprox. o 'No tengo'" required />
                </div>

              <div class="field">
                <label for="tipo">
                  <span>Tipo de propiedad de inter√©s</span>
                </label>
                <select id="tipo" name="tipo" required>
                  <option value="">Selecciona una opci√≥n</option>
                  <option value="studio">Studio</option>
                  <option value="1d">1 Dormitorio</option>
                  <option value="2d">2 Dormitorios</option>
                    <option value="todas">Todas las opciones</option>
                  </select>
                </div>

              <div class="field">
                <label for="contacto-preferencia">
                  <span>¬øC√≥mo prefieres que te contactemos?</span>
                </label>
                <select id="contacto-preferencia" name="contacto-preferencia" required>
                  <option value="">Selecciona una opci√≥n</option>
                    <option value="whatsapp">WhatsApp (recomendado)</option>
                    <option value="email">Correo electr√≥nico</option>
                    <option value="llamada">Llamada telef√≥nica</option>
                  </select>
              </div>
                </div>

            <div class="field-checkbox">
              <input id="terminos" name="terminos" type="checkbox" required />
              <label for="terminos">
                Acepto el tratamiento de mis datos y autorizo el contacto por WhatsApp y correo para recibir informaci√≥n sobre este proyecto inmobiliario.
                  </label>
                </div>

            <input type="hidden" name="cf-turnstile-response" id="ts-token" />
            
            <div class="form-footer">
              <p>‚è∞ Oferta sujeta a disponibilidad de unidades y vigencia de la promoci√≥n de lanzamiento.</p>
              
              <div class="turnstile-container" style="margin: 16px 0; display: flex; justify-content: center;">
                <div class="cf-turnstile" data-sitekey="0x4AAAAAAB_bjq2YOWp-yEXx" data-theme="auto" data-callback="onTurnstileSuccess"></div>
              </div>

              <button type="submit" class="btn-primary" id="form-submit-btn" disabled>
                <span class="btn-primary-icon">üìÑ</span>
                <span>Recibir mi propuesta personalizada</span>
                </button>
              </div>
            </form>
        </div>
      </section>

      <!-- FOOTER -->
      <footer class="footer">
        <div>
          <img src="/images/logo_negro.png" alt="Select Capital" class="footer-logo footer-logo-light" style="height: 32px; margin-bottom: 12px;" />
          <img src="/images/logo_blanco.png" alt="Select Capital" class="footer-logo footer-logo-dark" style="height: 32px; margin-bottom: 12px; display: none;" />
          <p style="margin: 0 0 8px 0; font-size: 12px;">
            <strong>Select Capital</strong> ¬∑ Asesor√≠a Inmobiliaria<br />
            Av. Apoquindo 6410, Of. 1203, Las Condes
          </p>
              </div>
              <div>
          <div class="footer-contact">
            <a href="https://wa.me/56966013182?text=Hola,%20quiero%20informaci√≥n%20sobre%20VIVA%20MAR√çN" target="_blank" rel="noopener" class="contact-link">
              <span>üí¨</span>
              <span>WhatsApp</span>
            </a>
            <a href="mailto:contacto@selectcapital.cl" class="contact-link">
              <span>‚úâÔ∏è</span>
              <span>contacto@selectcapital.cl</span>
            </a>
              </div>
          <p style="margin: 12px 0 0 0; font-size: 11px; color: var(--sc-text-tertiary, rgba(15, 23, 42, 0.5));">
            Promociones y precios en UF, sujetos a disponibilidad y modificaciones del plan de obra.
          </p>
            </div>
      </footer>
          </div>

    <!-- Sticky CTA Button (Mobile) -->
    <div class="sticky-cta" id="sticky-cta">
      <button type="button" class="sticky-cta-button" data-action="scroll-form">
        <span class="btn-primary-icon">üìÑ</span>
        <span>Quiero mi propuesta</span>
      </button>
    </div>

    <!-- Cloudflare Turnstile -->
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
    
    <!-- Google Maps JavaScript API - Key loaded from config -->
    <script>
      // Load Google Maps API key from server config
      (function() {
        const script = document.createElement('script');
        fetch('/api/maps-key.php')
          .then(res => res.json())
          .then(data => {
            if (data.key) {
              script.src = `https://maps.googleapis.com/maps/api/js?key=${data.key}&callback=initMap`;
              script.async = true;
              script.defer = true;
              document.head.appendChild(script);
            } else {
              console.warn('Google Maps API key not configured');
              // Fallback: show link to Google Maps
              const mapElement = document.getElementById('map');
              if (mapElement) {
                mapElement.innerHTML = '<div style="padding: 20px; text-align: center; color: #666;"><a href="https://www.google.com/maps/search/?api=1&query=Mar√≠n+Lira+Santiago+Centro" target="_blank" style="color: #1A237E; text-decoration: underline;">Ver ubicaci√≥n en Google Maps</a></div>';
              }
            }
          })
          .catch(err => {
            console.error('Error loading Google Maps API key:', err);
            const mapElement = document.getElementById('map');
            if (mapElement) {
              mapElement.innerHTML = '<div style="padding: 20px; text-align: center; color: #666;"><a href="https://www.google.com/maps/search/?api=1&query=Mar√≠n+Lira+Santiago+Centro" target="_blank" style="color: #1A237E; text-decoration: underline;">Ver ubicaci√≥n en Google Maps</a></div>';
            }
          });
      })();
    </script>
    
    <script type="module" src="/lenguaje visual/theme/theme-toggle.min.js"></script>
    <script>
      // Turnstile callback
      window.onTurnstileSuccess = function(token) {
        const tokenInput = document.getElementById('ts-token');
        const submitBtn = document.getElementById('form-submit-btn');
        if (tokenInput) {
          tokenInput.value = token;
        }
        if (submitBtn) {
          submitBtn.disabled = false;
        }
      };

      // Update theme icon based on current theme
      document.addEventListener('DOMContentLoaded', () => {
        const themeIcon = document.querySelector('[data-theme-icon]');
        const logoLight = document.querySelector('.header-logo .logo-light');
        const logoDark = document.querySelector('.header-logo .logo-dark');
        const footerLogoLight = document.querySelector('.footer-logo-light');
        const footerLogoDark = document.querySelector('.footer-logo-dark');
        
        const updateTheme = () => {
          const currentTheme = document.documentElement.getAttribute('data-theme');
          if (themeIcon) {
            themeIcon.textContent = currentTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
          }
          // Update header logo visibility
          if (logoLight && logoDark) {
            if (currentTheme === 'dark') {
              logoLight.style.display = 'none';
              logoDark.style.display = 'block';
            } else {
              logoLight.style.display = 'block';
              logoDark.style.display = 'none';
            }
          }
          // Update footer logo visibility
          if (footerLogoLight && footerLogoDark) {
            if (currentTheme === 'dark') {
              footerLogoLight.style.display = 'none';
              footerLogoDark.style.display = 'block';
            } else {
              footerLogoLight.style.display = 'block';
              footerLogoDark.style.display = 'none';
            }
          }
        };
        
        // Initial update
        updateTheme();
        
        // Watch for theme changes
        const observer = new MutationObserver(() => {
          updateTheme();
        });
        
        observer.observe(document.documentElement, {
          attributes: true,
          attributeFilter: ['data-theme']
        });

        // Smooth scroll to form
        const scrollFormBtn = document.querySelector('[data-action="scroll-form"]');
        const stickyCtaBtn = document.querySelector('.sticky-cta-button[data-action="scroll-form"]');
        
        const scrollToForm = (e) => {
          if (e) e.preventDefault();
          const formSection = document.getElementById('contacto');
          if (formSection) {
            formSection.scrollIntoView({ 
              behavior: 'smooth', 
              block: 'start' 
            });
          }
        };
        
        if (scrollFormBtn) {
          scrollFormBtn.addEventListener('click', scrollToForm);
        }
        if (stickyCtaBtn) {
          stickyCtaBtn.addEventListener('click', scrollToForm);
        }

        // Sticky CTA visibility control
        const stickyCta = document.getElementById('sticky-cta');
        const formSection = document.getElementById('contacto');
        
        if (stickyCta && formSection) {
          const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.1
          };
          
          const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
              if (entry.isIntersecting) {
                // Form is visible, hide sticky CTA
                stickyCta.classList.remove('is-visible');
              } else {
                // Form is not visible, show sticky CTA (only if scrolled past hero)
                const heroBottom = document.querySelector('.header')?.getBoundingClientRect().bottom || 0;
                if (window.scrollY > heroBottom + 100) {
                  stickyCta.classList.add('is-visible');
                } else {
                  stickyCta.classList.remove('is-visible');
                }
              }
            });
          }, observerOptions);
          
          observer.observe(formSection);
          
          // Also check on scroll
          let ticking = false;
          window.addEventListener('scroll', () => {
            if (!ticking) {
              window.requestAnimationFrame(() => {
                const heroBottom = document.querySelector('.header')?.getBoundingClientRect().bottom || 0;
                const formRect = formSection.getBoundingClientRect();
                const isFormVisible = formRect.top < window.innerHeight && formRect.bottom > 0;
                
                if (isFormVisible) {
                  stickyCta.classList.remove('is-visible');
                } else if (window.scrollY > heroBottom + 100) {
                  stickyCta.classList.add('is-visible');
                } else {
                  stickyCta.classList.remove('is-visible');
                }
                
                ticking = false;
              });
              ticking = true;
            }
          });
        }

        // ============================================
        // FORM FIELD NORMALIZATION FUNCTIONS
        // ============================================
        
        // Normalize RUT: Format to 12.345.678-9 and validate
        function normalizeRUT(value) {
          if (!value) return '';
          
          // Remove all non-alphanumeric except dots and dash
          let clean = value.replace(/[^0-9kK\.-]/g, '');
          
          // Extract number and digit
          const parts = clean.split('-');
          let number = parts[0]?.replace(/\./g, '') || '';
          let digit = parts[1] || '';
          
          // If no dash, try to extract last character as digit
          if (!digit && number.length > 0) {
            const lastChar = number.slice(-1);
            if (lastChar.toLowerCase() === 'k' || lastChar === '0') {
              digit = lastChar;
              number = number.slice(0, -1);
            } else if (number.length > 1) {
              digit = number.slice(-1);
              number = number.slice(0, -1);
            }
          }
          
          // Format number with dots
          if (number) {
            number = number.replace(/\D/g, '');
            const formatted = number.replace(/\B(?=(\d{3})+(?!\d))/g, '.');
            return digit ? `${formatted}-${digit.toUpperCase()}` : formatted;
          }
          
          return clean;
        }
        
        // Validate RUT digit
        function validateRUT(rut) {
          if (!rut) return false;
          
          const clean = rut.replace(/\./g, '').replace(/-/g, '');
          if (clean.length < 8 || clean.length > 10) return false;
          
          const number = clean.slice(0, -1);
          const digit = clean.slice(-1).toUpperCase();
          
          let sum = 0;
          let multiplier = 2;
          
          for (let i = number.length - 1; i >= 0; i--) {
            sum += parseInt(number[i]) * multiplier;
            multiplier = multiplier === 7 ? 2 : multiplier + 1;
          }
          
          const remainder = sum % 11;
          const calculatedDigit = remainder < 2 ? remainder.toString() : (11 - remainder).toString();
          const expectedDigit = calculatedDigit === '11' ? '0' : calculatedDigit === '10' ? 'K' : calculatedDigit;
          
          return digit === expectedDigit;
        }
        
        // Normalize phone/WhatsApp: Format to +56 9 xxxx xxxx
        function normalizePhone(value) {
          if (!value) return '';
          
          // Remove all non-digits
          let clean = value.replace(/\D/g, '');
          
          // If starts with 56, keep it; otherwise assume it's a Chilean number
          if (clean.startsWith('56')) {
            clean = clean.substring(2);
          }
          
          // Remove leading 0 if present
          if (clean.startsWith('0')) {
            clean = clean.substring(1);
          }
          
          // Ensure it starts with 9 (Chilean mobile)
          if (!clean.startsWith('9') && clean.length >= 8) {
            clean = '9' + clean;
          }
          
          // Format: +56 9 xxxx xxxx
          if (clean.length >= 8) {
            const area = clean.substring(0, 1); // 9
            const part1 = clean.substring(1, 5); // xxxx
            const part2 = clean.substring(5, 9); // xxxx
            return `+56 ${area} ${part1} ${part2}`.trim();
          }
          
          return value; // Return as-is if can't format
        }
        
        // Normalize email: trim and lowercase
        function normalizeEmail(value) {
          if (!value) return '';
          return value.trim().toLowerCase();
        }
        
        // Normalize name: Proper capitalization
        function normalizeName(value) {
          if (!value) return '';
          
          return value
            .trim()
            .split(/\s+/)
            .map(word => {
              if (word.length === 0) return '';
              // Handle special prefixes (de, del, la, etc.)
              const lowerWords = ['de', 'del', 'la', 'las', 'los', 'el', 'y', 'e'];
              if (lowerWords.includes(word.toLowerCase())) {
                return word.toLowerCase();
              }
              // Capitalize first letter, lowercase rest
              return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();
            })
            .join(' ');
        }
        
        // Normalize number: Remove formatting, keep only digits
        function normalizeNumber(value) {
          if (!value) return '';
          // Remove all non-digits except decimal point
          return value.replace(/[^\d]/g, '');
        }
        
        // Format number with thousands separator
        function formatNumber(value) {
          if (!value) return '';
          const clean = normalizeNumber(value);
          if (!clean) return '';
          return clean.replace(/\B(?=(\d{3})+(?!\d))/g, '.');
        }
        
        // ============================================
        // APPLY NORMALIZATION TO FORM FIELDS
        // ============================================
        
        const form = document.querySelector('.form');
        if (form) {
          // RUT normalization
          const rutInput = form.querySelector('#rut');
          if (rutInput) {
            rutInput.addEventListener('input', (e) => {
              const normalized = normalizeRUT(e.target.value);
              if (normalized !== e.target.value) {
                const cursorPos = e.target.selectionStart;
                e.target.value = normalized;
                // Try to maintain cursor position
                const newPos = Math.min(cursorPos, normalized.length);
                e.target.setSelectionRange(newPos, newPos);
              }
            });
            
            rutInput.addEventListener('blur', (e) => {
              const normalized = normalizeRUT(e.target.value);
              if (normalized && !validateRUT(normalized)) {
                e.target.style.borderColor = 'rgba(248, 113, 113, 0.5)';
              } else {
                e.target.style.borderColor = '';
              }
              e.target.value = normalized;
            });
          }
          
          // Phone normalization
          const phoneInput = form.querySelector('#telefono');
          if (phoneInput) {
            phoneInput.addEventListener('input', (e) => {
              const normalized = normalizePhone(e.target.value);
              if (normalized !== e.target.value) {
                const cursorPos = e.target.selectionStart;
                e.target.value = normalized;
                const newPos = Math.min(cursorPos, normalized.length);
                e.target.setSelectionRange(newPos, newPos);
              }
            });
            
            phoneInput.addEventListener('blur', (e) => {
              const normalized = normalizePhone(e.target.value);
              e.target.value = normalized;
            });
          }
          
          // Email normalization
          const emailInput = form.querySelector('#correo');
          if (emailInput) {
            emailInput.addEventListener('blur', (e) => {
              e.target.value = normalizeEmail(e.target.value);
            });
          }
          
          // Name normalization
          const nameInput = form.querySelector('#nombre');
          if (nameInput) {
            nameInput.addEventListener('blur', (e) => {
              e.target.value = normalizeName(e.target.value);
            });
          }
          
          // Number formatting for renta
          const rentaInput = form.querySelector('#renta');
          if (rentaInput) {
            rentaInput.addEventListener('input', (e) => {
              const clean = normalizeNumber(e.target.value);
              if (clean) {
                const formatted = formatNumber(clean);
                if (formatted !== e.target.value) {
                  const cursorPos = e.target.selectionStart;
                  e.target.value = formatted;
                  const newPos = Math.min(cursorPos, formatted.length);
                  e.target.setSelectionRange(newPos, newPos);
                }
              }
            });
          }
          
          // Ahorro field (allow text like "No tengo")
          const ahorroInput = form.querySelector('#ahorro');
          if (ahorroInput) {
            ahorroInput.addEventListener('input', (e) => {
              const value = e.target.value;
              // If it's not "no tengo" or similar, format as number
              if (!/no\s+tengo/i.test(value) && /\d/.test(value)) {
                const clean = normalizeNumber(value);
                if (clean) {
                  const formatted = formatNumber(clean);
                  if (formatted !== value) {
                    const cursorPos = e.target.selectionStart;
                    e.target.value = formatted;
                    const newPos = Math.min(cursorPos, formatted.length);
                    e.target.setSelectionRange(newPos, newPos);
                  }
                }
              }
            });
          }
        }
        
        // Form validation and submission
        const submitBtn = document.getElementById('form-submit-btn');
        
        if (form && submitBtn) {
          form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const tokenInput = document.getElementById('ts-token');
            if (!tokenInput || !tokenInput.value) {
              showFormMessage('Por favor, completa la verificaci√≥n de seguridad antes de enviar.', 'error');
              return false;
            }

            // Normalize all fields before validation
            const rutInput = form.querySelector('#rut');
            const telefonoInput = form.querySelector('#telefono');
            const correoInput = form.querySelector('#correo');
            const nombreInput = form.querySelector('#nombre');
            const rentaInput = form.querySelector('#renta');
            const ahorroInput = form.querySelector('#ahorro');
            
            // Normalize RUT
            if (rutInput) {
              const normalizedRUT = normalizeRUT(rutInput.value);
              rutInput.value = normalizedRUT;
              
              if (normalizedRUT && !validateRUT(normalizedRUT)) {
                showFormMessage('Por favor, ingresa un RUT v√°lido. El d√≠gito verificador no es correcto.', 'error');
                rutInput.focus();
                return false;
              }
              
              if (normalizedRUT) {
                const cleanRut = normalizedRUT.replace(/\./g, '').replace(/-/g, '');
                if (cleanRut.length < 8 || cleanRut.length > 10) {
                  showFormMessage('Por favor, ingresa un RUT v√°lido en formato: 12.345.678-9', 'error');
                  rutInput.focus();
                  return false;
                }
              }
            }
            
            // Normalize phone
            if (telefonoInput) {
              const normalizedPhone = normalizePhone(telefonoInput.value);
              telefonoInput.value = normalizedPhone;
              
              const whatsappPattern = /^\+56\s9\s\d{4}\s\d{4}$/;
              if (normalizedPhone && !whatsappPattern.test(normalizedPhone)) {
                showFormMessage('Por favor, ingresa un n√∫mero de WhatsApp v√°lido en formato: +56 9 xxxx xxxx', 'error');
                telefonoInput.focus();
                return false;
              }
            }
            
            // Normalize email
            if (correoInput) {
              correoInput.value = normalizeEmail(correoInput.value);
            }
            
            // Normalize name
            if (nombreInput) {
              nombreInput.value = normalizeName(nombreInput.value);
            }
            
            // Normalize numbers (remove formatting for backend)
            if (rentaInput) {
              rentaInput.dataset.originalValue = rentaInput.value; // Store formatted for display
            }
            
            if (ahorroInput) {
              const ahorroValue = ahorroInput.value;
              if (!/no\s+tengo/i.test(ahorroValue) && /\d/.test(ahorroValue)) {
                ahorroInput.dataset.originalValue = ahorroValue; // Store formatted
              }
            }

            // Disable button and show loading state
            submitBtn.disabled = true;
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<span class="btn-primary-icon">‚è≥</span><span>Enviando...</span>';
            submitBtn.style.opacity = '0.7';
            submitBtn.style.cursor = 'not-allowed';

            // Remove any existing messages
            removeFormMessages();

            try {
              // Create FormData and map fields to backend expected format
              const formData = new FormData();
              
              // Map form fields to backend expected fields (using normalized values)
              formData.append('nombre', form.querySelector('#nombre')?.value || '');
              formData.append('rut', form.querySelector('#rut')?.value || '');
              formData.append('email', form.querySelector('#correo')?.value || '');
              formData.append('whatsapp', form.querySelector('#telefono')?.value || '');
              formData.append('objetivo', form.querySelector('#objetivo')?.value || '');
              formData.append('tipo_ingreso', 'dependiente'); // Default value (form doesn't have this field)
              
              // Send renta as clean number (without formatting)
              const rentaValue = form.querySelector('#renta')?.value || '';
              formData.append('renta_liquida', normalizeNumber(rentaValue) || '');
              
              // Handle ahorro field
              const ahorroValue = form.querySelector('#ahorro')?.value || '';
              const tieneAhorro = /no\s+tengo/i.test(ahorroValue) ? 'no' : 'si';
              formData.append('tiene_ahorro', tieneAhorro);
              // Send ahorro as clean number if it's a number, otherwise as text
              if (tieneAhorro === 'si' && /\d/.test(ahorroValue)) {
                formData.append('monto_ahorro', normalizeNumber(ahorroValue) || '0');
              } else {
                formData.append('monto_ahorro', '0');
              }
              // capacidad_ahorro_mensual is required but not in form - send default value
              formData.append('capacidad_ahorro_mensual', '0');
              
              formData.append('comunas_interes', 'Santiago Centro'); // Project location
              formData.append('canal_preferido', form.querySelector('#contacto-preferencia')?.value || 'whatsapp');
              formData.append('franja_preferida', 'flexible'); // Default value (form doesn't have this field)
              formData.append('consentimiento_privacidad', form.querySelector('#terminos')?.checked ? 'si' : 'no');
              formData.append('consentimiento_contacto', form.querySelector('#terminos')?.checked ? 'si' : 'no');
              
              // Add tipo as comentarios for reference
              const tipoValue = form.querySelector('#tipo')?.value || '';
              if (tipoValue) {
                formData.append('comentarios', `Tipo de propiedad de inter√©s: ${tipoValue}`);
              }
              
              // Add Turnstile token
              formData.append('cf-turnstile-response', tokenInput.value);
              
              // Honeypot field (empty)
              formData.append('honey', '');
              
              // Submit form
              const response = await fetch('/submit.php', {
                method: 'POST',
                body: formData
              });

              const result = await response.json();

              if (result.ok) {
                // Success - redirect to gracias page
                const nombre = form.querySelector('#nombre')?.value || '';
                const redirectUrl = `/gracias.html${nombre ? '?nombre=' + encodeURIComponent(nombre) : ''}`;
                window.location.href = redirectUrl;
              } else {
                throw new Error(result.message || 'Error al enviar el formulario');
              }
            } catch (error) {
              // Log error in development only
              if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1' || window.location.hostname.includes('dev.')) {
                console.error('Form submission error:', error);
              }
              showFormMessage(
                error.message || 'Hubo un problema al enviar tu solicitud. Por favor intenta nuevamente.',
                'error'
              );
              
              // Re-enable button
              submitBtn.disabled = false;
              submitBtn.innerHTML = originalText;
              submitBtn.style.opacity = '1';
              submitBtn.style.cursor = 'pointer';
            }
          });
        }

        // Helper functions for form messages
        function showFormMessage(message, type) {
          removeFormMessages();
          
          const messageEl = document.createElement('div');
          messageEl.className = `form-message ${type}`;
          messageEl.innerHTML = `
            <strong>${type === 'success' ? '‚úì' : '‚ö†'}</strong>
            <span>${message}</span>
          `;
          messageEl.style.cssText = `
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 14px 18px;
            border-radius: 12px;
            margin: 16px 0;
            font-size: 14px;
            line-height: 1.5;
            ${type === 'success' 
              ? 'background: rgba(34, 197, 94, 0.1); border: 1.5px solid rgba(34, 197, 94, 0.3); color: #16a34a;' 
              : 'background: rgba(248, 113, 113, 0.1); border: 1.5px solid rgba(248, 113, 113, 0.3); color: #dc2626;'
            }
          `;
          
          const formFooter = document.querySelector('.form-footer');
          if (formFooter) {
            formFooter.insertBefore(messageEl, formFooter.firstChild);
          }
        }

        function removeFormMessages() {
          document.querySelectorAll('.form-message').forEach(el => el.remove());
        }

        // ============================================
        // LIGHTBOX / MODAL FOR TYPOLOGY IMAGES
        // ============================================
        const lightboxModal = document.createElement('div');
        lightboxModal.className = 'lightbox-modal';
        lightboxModal.innerHTML = `
          <div class="lightbox-backdrop"></div>
          <div class="lightbox-content">
            <button class="lightbox-close" aria-label="Cerrar" type="button">
              <span>√ó</span>
        </button>
            <div class="lightbox-image-wrapper">
              <img class="lightbox-image" src="" alt="" />
      </div>
            <div class="lightbox-title"></div>
          </div>
        `;
        document.body.appendChild(lightboxModal);

        const lightboxBackdrop = lightboxModal.querySelector('.lightbox-backdrop');
        const lightboxClose = lightboxModal.querySelector('.lightbox-close');
        const lightboxImage = lightboxModal.querySelector('.lightbox-image');
        const lightboxTitle = lightboxModal.querySelector('.lightbox-title');

        function openLightbox(imageSrc, title) {
          lightboxImage.src = imageSrc;
          lightboxImage.alt = title;
          lightboxTitle.textContent = title;
          lightboxModal.classList.add('is-open');
          document.body.style.overflow = 'hidden';
        }

        function closeLightbox() {
          lightboxModal.classList.remove('is-open');
          document.body.style.overflow = '';
        }

        // Event listeners for lightbox
        document.querySelectorAll('[data-lightbox="true"]').forEach(wrapper => {
          wrapper.style.cursor = 'pointer';
          wrapper.addEventListener('click', (e) => {
            e.preventDefault();
            const imageSrc = wrapper.getAttribute('data-image');
            const title = wrapper.getAttribute('data-title') || '';
            openLightbox(imageSrc, title);
          });
        });

        // Close on backdrop click
        lightboxBackdrop.addEventListener('click', closeLightbox);

        // Close on close button click
        lightboxClose.addEventListener('click', closeLightbox);

        // Close on Escape key
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && lightboxModal.classList.contains('is-open')) {
            closeLightbox();
          }
        });
      });

      // Sticky Navigation
      const stickyNav = document.getElementById('sticky-nav');
      const mainThemeToggle = document.querySelector('[data-theme-toggle]');
      const navThemeToggle = document.querySelector('[data-theme-toggle-nav]');
      const mainThemeIcon = document.querySelector('[data-theme-icon]');
      const navThemeIcon = document.querySelector('[data-theme-icon-nav]');

      // Show/hide sticky nav on scroll
      let lastScroll = 0;
      window.addEventListener('scroll', () => {
        const currentScroll = window.pageYOffset;
        
        if (currentScroll > 200) {
          stickyNav.classList.add('is-visible');
        } else {
          stickyNav.classList.remove('is-visible');
        }
        
        lastScroll = currentScroll;
      });

      // Sync theme toggles
      if (navThemeToggle) {
        navThemeToggle.addEventListener('click', () => {
          mainThemeToggle.click();
        });
      }

      // Sync theme icons when theme changes
      const syncThemeIcons = () => {
        const currentTheme = document.body.getAttribute('data-theme');
        const icon = currentTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        mainThemeIcon.textContent = icon;
        navThemeIcon.textContent = icon;
      };

      // Observer for theme changes
      const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
          if (mutation.attributeName === 'data-theme') {
            syncThemeIcons();
          }
        });
      });

      observer.observe(document.body, {
        attributes: true,
        attributeFilter: ['data-theme']
      });


      // Smooth scroll for sticky nav links
      document.querySelectorAll('.sticky-nav-links a').forEach(link => {
        link.addEventListener('click', (e) => {
          e.preventDefault();
          const targetId = link.getAttribute('href');
          const targetElement = document.querySelector(targetId);
          
          if (targetElement) {
            const offsetTop = targetElement.getBoundingClientRect().top + window.pageYOffset - 100;
            window.scrollTo({
              top: offsetTop,
              behavior: 'smooth'
            });
          }
        });
      });

      // Initialize theme icons
      syncThemeIcons();

      // ============================================
      // GOOGLE MAPS INITIALIZATION
      // ============================================
      // Make initMap globally available for Google Maps callback
      window.initMap = function() {
        const location = { lat: -33.437, lng: -70.648 };
        const mapElement = document.getElementById('map');
        
        if (!mapElement) {
          console.warn('Map element not found');
          return;
        }

        // Check if Google Maps API is loaded
        if (typeof google === 'undefined' || !google.maps) {
          console.error('Google Maps API not loaded');
          mapElement.innerHTML = '<div style="padding: 20px; text-align: center; color: #666;"><a href="https://www.google.com/maps/search/?api=1&query=Mar√≠n+Lira+Santiago+Centro" target="_blank" style="color: #1A237E; text-decoration: underline;">Ver ubicaci√≥n en Google Maps</a></div>';
          return;
        }

        try {
          const map = new google.maps.Map(mapElement, {
            zoom: 16,
            center: location,
            mapTypeId: 'roadmap',
            styles: [
              {
                featureType: 'poi',
                elementType: 'labels',
                stylers: [{ visibility: 'off' }]
              }
            ],
            disableDefaultUI: false,
            zoomControl: true,
            mapTypeControl: false,
            scaleControl: true,
            streetViewControl: false,
            rotateControl: false,
            fullscreenControl: true
          });

          const marker = new google.maps.Marker({
            position: location,
            map: map,
            title: 'VIVA MAR√çN - Esquina Mar√≠n con Lira, Santiago Centro',
            animation: google.maps.Animation.DROP
          });

          const infoWindow = new google.maps.InfoWindow({
            content: '<div style="padding: 8px;"><strong>VIVA MAR√çN</strong><br>Esquina Mar√≠n con Lira<br>Santiago Centro</div>'
          });

          marker.addListener('click', () => {
            infoWindow.open(map, marker);
          });
        } catch (error) {
          console.error('Error initializing Google Maps:', error);
          mapElement.innerHTML = '<div style="padding: 20px; text-align: center; color: #666;"><a href="https://www.google.com/maps/search/?api=1&query=Mar√≠n+Lira+Santiago+Centro" target="_blank" style="color: #1A237E; text-decoration: underline;">Ver ubicaci√≥n en Google Maps</a></div>';
        }
      };

      // Fallback if Google Maps fails to load
      window.gm_authFailure = function() {
        console.error('Google Maps authentication failed. Please check your API key.');
        const mapElement = document.getElementById('map');
        if (mapElement) {
          mapElement.innerHTML = '<div style="padding: 20px; text-align: center; color: #666;">Error al cargar el mapa. <a href="https://www.google.com/maps/search/?api=1&query=Mar√≠n+Lira+Santiago+Centro" target="_blank" style="color: #1A237E; text-decoration: underline;">Ver en Google Maps</a></div>';
        }
      };
    </script>
  </body>
</html>

