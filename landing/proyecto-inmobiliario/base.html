<!doctype html>
<html lang="es" data-theme="light" data-theme-transition>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Nuevo Proyecto en Santiago Centro â€” Select Capital</title>
    <meta name="description" content="Invierte en Santiago Centro desde UF 2.350. Pie 10% en 48 cuotas, 15% descuento lanzamiento. AsesorÃ­a sin costo." />
    <meta name="theme-color" content="#F6F8FC" />
    <link rel="icon" href="/images/icono.png" />
    
    <!-- DNS Prefetch para recursos externos -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
    <link rel="dns-prefetch" href="https://fonts.gstatic.com" />
    <link rel="dns-prefetch" href="https://challenges.cloudflare.com" />
    
    <!-- Preconnect para recursos crÃ­ticos -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    
    <!-- Preload de fuente crÃ­tica -->
    <link rel="preload" href="https://fonts.gstatic.com/s/inter/v13/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfAZ9hiJ-Ek-_EeA.woff2" as="font" type="font/woff2" crossorigin />
    
    <!-- Fuentes con font-display swap -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    
    <!-- CSS crÃ­tico -->
    <link rel="stylesheet" href="/lenguaje visual/theme/select-capital-theme.min.css?v=66e592e976" />
    <link rel="stylesheet" href="/lenguaje visual/forms/sc-forms.css?v=20250118" />
    <link rel="stylesheet" href="/landing/proyecto-inmobiliario/viva-marin-styles.css?v=20250118-4" />
  </head>
  <body>
    <button class="theme-toggle" type="button" data-theme-toggle aria-label="Cambiar tema">
      <span data-theme-icon>ğŸŒ™</span>
    </button>

    <nav class="sticky-nav" id="sticky-nav">
      <div class="sticky-nav-content">
        <img src="/images/logo_blanco.png" alt="Select Capital" class="sticky-nav-logo" />
        <div class="sticky-nav-links">
          <a href="#tipologias">TipologÃ­as</a>
          <a href="#ubicacion">UbicaciÃ³n</a>
          <a href="#contacto">Cotizar</a>
        </div>
      </div>
    </nav>

    <div class="page">
      <!-- HEADER / HERO -->
      <header class="header">
        <div class="header-logo">
          <img src="/images/logo_negro.png" alt="Select Capital" class="logo-light" />
          <img src="/images/logo_blanco.png" alt="Select Capital" class="logo-dark" style="display: none;" />
        </div>

        <div class="header-main">
          <div class="hero-content-wrapper">
            <div class="hero-text-content">
              <h1 class="headline">
                Invierte en <span>Santiago Centro</span><br />
                desde UF 2.350
              </h1>
              <p class="subheadline">
                Edificio de solo 162 departamentos en el corazÃ³n de Santiago Centro, pensado para quienes quieren vivir o invertir sin perder tranquilidad.
              </p>

              <!-- Hero Image - MÃ³vil: despuÃ©s del tÃ­tulo y subtÃ­tulo -->
              <div class="hero-media-mobile">
                <div class="hero-tagline">Nuevo Proyecto â€” Santiago Centro</div>
                <div class="hero-title">162 departamentos de 1 y 2 dormitorios</div>
                <div class="hero-image-placeholder">
                  <img src="/images/viva marin/fachada.png" alt="Fachada principal del proyecto" loading="eager" fetchpriority="high" width="600" height="800" decoding="async" />
                </div>
            </div>

              <div class="header-grid">
                <div class="pill">
                  <span>PromociÃ³n lanzamiento</span>
                  <strong>15% de descuento</strong>
                </div>
                <div class="pill">
                  <span>Pie 10%</span>
                  <strong>En hasta 48 cuotas</strong>
                </div>
                <div class="pill">
                  <span>TipologÃ­as</span>
                  <strong>Estudio Â· 1D Â· 2D</strong>
                </div>
                <div class="pill">
                  <span>Entrega estimada</span>
                  <strong>Mediados 2028</strong>
                </div>
              </div>
            </div>

            <div class="hero-cta-section">
              <button type="button" class="hero-cta-primary" data-action="scroll-form">
                <span class="btn-primary-icon">ğŸ“„</span>
                <span>Quiero mi propuesta</span>
              </button>
            </div>
            </div>

          <!-- Hero Image - Desktop: lado derecho -->
          <div class="hero-media">
            <div class="hero-tagline">Nuevo Proyecto â€” Santiago Centro</div>
            <div class="hero-title">162 departamentos de 1 y 2 dormitorios</div>
            <div class="hero-image-placeholder">
              <img src="/images/viva marin/fachada.png" alt="Fachada principal del proyecto" loading="eager" fetchpriority="high" width="600" height="800" decoding="async" />
              </div>
              </div>
            </div>
      </header>

      <!-- DATOS CLAVE / DESCRIPCIÃ“N -->
      <section class="section" id="datos-clave">
        <div class="section-header">
          <h2 class="section-title">Datos clave del proyecto</h2>
          <p class="section-kicker">Resumen rÃ¡pido: precio de entrada, etapas y contexto</p>
            </div>

        <div class="card" style="margin-bottom: 16px;">
          <div class="card-grid">
            <div>
              <div class="metric-label">Desde</div>
              <div class="metric-value">UF 2.350</div>
              <div class="metric-hint">Valores referenciales</div>
            </div>
            <div>
              <div class="metric-label">TipologÃ­as</div>
              <div class="metric-value">Estudio Â· 1D Â· 2D</div>
              <div class="metric-hint">162 departamentos</div>
        </div>
            <div>
              <div class="metric-label">Pie</div>
              <div class="metric-value">10% en 48 cuotas</div>
              <div class="metric-hint">PromociÃ³n lanzamiento</div>
              </div>
            <div>
              <div class="metric-label">Entrega</div>
              <div class="metric-value">Mediados 2028</div>
              <div class="metric-hint">Etapa verde</div>
            </div>
          </div>
        </div>

        <div class="description-showcase">
          <div class="description-card">
            <div class="description-icon">ğŸ“</div>
            <div class="description-content">
              <h3 class="description-title">UbicaciÃ³n estratÃ©gica</h3>
              <p class="description-text">
                En pleno corazÃ³n de Santiago Centro, se levanta un nuevo proyecto inmobiliario: un edificio de solo 162 departamentos â€” 1 y 2 dormitorios â€” pensado para quienes buscan conectar con la ciudad sin sacrificar tranquilidad.
              </p>
              </div>
            </div>

          <div class="description-features">
            <div class="feature-item">
              <span class="feature-icon">ğŸš‡</span>
              <span class="feature-text">A pasos de metro</span>
              </div>
            <div class="feature-item">
              <span class="feature-icon">ğŸ¥</span>
              <span class="feature-text">Hospitales cercanos</span>
            </div>
            <div class="feature-item">
              <span class="feature-icon">ğŸ“</span>
              <span class="feature-text">Universidades</span>
          </div>
            <div class="feature-item">
              <span class="feature-icon">ğŸ›’</span>
              <span class="feature-text">Comercio urbano</span>
        </div>
          </div>

          <div class="description-highlight">
            <div class="highlight-badge">ğŸš€ Futura LÃ­nea 9</div>
            <p class="highlight-text">
              La futura <strong>LÃ­nea 9 del Metro de Santiago</strong> se trazarÃ¡ por la Avenida Santa Rosa, lo que incrementa la expectativa de <strong>valorizaciÃ³n del sector</strong> en el mediano plazo.
            </p>
          </div>
        </div>
      </section>

      <!-- EXPERIENCIA / AMENITIES -->
      <section class="section" id="experiencia">
        <div class="section-header">
          <h2 class="section-title">Experiencia del proyecto</h2>
          <p class="section-kicker">Espacios comunes, amenities y zonas pensadas para el dÃ­a a dÃ­a</p>
              </div>

        <div class="amenities-grid">
          <article class="amenity-card">
            <div class="amenity-media">
              <img src="/images/viva marin/fachada.png" alt="Fachada principal del proyecto" loading="lazy" width="400" height="533" decoding="async" />
            </div>
            <div class="amenity-title">Fachada principal</div>
            <div class="amenity-caption">Arquitectura moderna que se integra al tejido urbano de Santiago Centro.</div>
          </article>

          <article class="amenity-card">
            <div class="amenity-media">
              <img src="/images/viva marin/halldepto.png" alt="Living del proyecto" loading="lazy" width="400" height="533" decoding="async" />
              </div>
            <div class="amenity-title">Living</div>
            <div class="amenity-caption">Espacios amplios y luminosos para disfrutar en familia.</div>
          </article>

          <article class="amenity-card">
            <div class="amenity-media">
              <img src="/images/viva marin/cocina.png" alt="Cocina del proyecto" loading="lazy" width="400" height="533" decoding="async" />
            </div>
            <div class="amenity-title">Cocina</div>
            <div class="amenity-caption">DiseÃ±o moderno y funcional con equipamiento de primera calidad.</div>
          </article>

          <article class="amenity-card">
            <div class="amenity-media">
              <img src="/images/viva marin/dormitorio.png" alt="HabitaciÃ³n del proyecto" loading="lazy" width="400" height="533" decoding="async" />
          </div>
            <div class="amenity-title">HabitaciÃ³n</div>
            <div class="amenity-caption">Dormitorios amplios y confortables para tu descanso.</div>
          </article>
        </div>
      </section>

      <!-- TIPOLOGÃAS Y PLANOS -->
      <section class="section" id="tipologias">
        <div class="section-header">
          <h2 class="section-title">TipologÃ­as disponibles</h2>
          <p class="section-kicker">Conoce los departamentos y sus superficies</p>
          </div>

        <div class="typologies-grid">
          <!-- Studio -->
          <article class="typology-card">
            <div class="typology-image-wrapper" data-lightbox="true" data-image="/images/viva marin/render_studio.png" data-title="Studio - DEPTO 310 AL 910">
              <img src="/images/viva marin/render_studio.png" alt="Plano Studio del proyecto" loading="lazy" decoding="async" />
        </div>
            <div class="typology-content">
              <div class="typology-header">
                <h3 class="typology-title">Studio</h3>
                <span class="typology-badge">DEPTO 310 AL 910</span>
              </div>
              <div class="typology-specs">
                <div class="spec-item">
                  <span class="spec-label">Superficie Interior</span>
                  <span class="spec-value">20.62 mÂ²</span>
                </div>
                <div class="spec-item">
                  <span class="spec-label">Sup. Terraza (100%)</span>
                  <span class="spec-value">0.00 mÂ²</span>
                </div>
                <div class="spec-item spec-total">
                  <span class="spec-label">SUP. TOTAL</span>
                  <span class="spec-value">20.62 mÂ²</span>
                </div>
              </div>
            </div>
          </article>

          <!-- 1 Dormitorio -->
          <article class="typology-card">
            <div class="typology-image-wrapper" data-lightbox="true" data-image="/images/viva marin/render_1d1b.png" data-title="1 Dormitorio - DEPTO 308 AL 908">
              <img src="/images/viva marin/render_1d1b.png" alt="Plano 1 Dormitorio del proyecto" loading="lazy" decoding="async" />
          </div>
            <div class="typology-content">
              <div class="typology-header">
                <h3 class="typology-title">1 Dormitorio</h3>
                <span class="typology-badge">DEPTO 308 AL 908</span>
        </div>
              <div class="typology-specs">
                <div class="spec-item">
                  <span class="spec-label">Superficie Interior</span>
                  <span class="spec-value">29.25 mÂ²</span>
                </div>
                <div class="spec-item">
                  <span class="spec-label">Sup. Terraza (100%)</span>
                  <span class="spec-value">2.00 mÂ²</span>
                </div>
                <div class="spec-item spec-total">
                  <span class="spec-label">SUP. TOTAL</span>
                  <span class="spec-value">31.25 mÂ²</span>
                </div>
              </div>
            </div>
          </article>

          <!-- 2 Dormitorios -->
          <article class="typology-card">
            <div class="typology-image-wrapper" data-lightbox="true" data-image="/images/viva marin/render_2d2b.png" data-title="2 Dormitorios - DEPTO 202 AL 902">
              <img src="/images/viva marin/render_2d2b.png" alt="Plano 2 Dormitorios del proyecto" loading="lazy" decoding="async" />
            </div>
            <div class="typology-content">
              <div class="typology-header">
                <h3 class="typology-title">2 Dormitorios</h3>
                <span class="typology-badge">DEPTO 202 AL 902</span>
              </div>
              <div class="typology-specs">
                <div class="spec-item">
                  <span class="spec-label">Superficie Interior</span>
                  <span class="spec-value">49.40 mÂ²</span>
            </div>
                <div class="spec-item">
                  <span class="spec-label">Sup. Terraza (100%)</span>
                  <span class="spec-value">2.03 mÂ²</span>
          </div>
                <div class="spec-item spec-total">
                  <span class="spec-label">SUP. TOTAL</span>
                  <span class="spec-value">51.43 mÂ²</span>
                </div>
              </div>
            </div>
          </article>
        </div>
      </section>

      <!-- UBICACIÃ“N Y CONECTIVIDAD -->
      <section class="section" id="ubicacion">
        <div class="section-header">
          <h2 class="section-title">UbicaciÃ³n y conectividad</h2>
          <p class="section-kicker">Todo lo que necesitas, a minutos caminando</p>
          </div>

        <div class="location-grid">
          <div>
            <ul class="list">
              <li>
                <div class="list-icon">ğŸ“</div>
                <div class="list-content">
                  <span>EducaciÃ³n</span>
                  <strong>Universidad CatÃ³lica Â· 5 min</strong>
        </div>
              </li>
              <li>
                <div class="list-icon">ğŸ›’</div>
                <div class="list-content">
                  <span>Comercio</span>
                  <strong>Strip Center Portugal Â· 6 min</strong>
            </div>
              </li>
              <li>
                <div class="list-icon">ğŸš‡</div>
                <div class="list-content">
                  <span>Metro</span>
                  <strong>Santa LucÃ­a Â· 10 min</strong>
          </div>
              </li>
              <li>
                <div class="list-icon">ğŸ¥</div>
                <div class="list-content">
                  <span>Salud</span>
                  <strong>Hospital del Salvador Â· 6 min</strong>
        </div>
              </li>
            </ul>

            <p class="text-block" style="margin-top: 16px;">
              EstÃ¡s en el <strong>centro histÃ³rico de Santiago</strong>, una zona con alta plusvalÃ­a por su conectividad, servicios y vida urbana. Ideal para renta de largo plazo y para profesionales que buscan cercanÃ­a con todo.
              </p>
          </div>

          <div class="map-card">
            <iframe 
              src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d26636.84433823647!2d-70.66813882414057!3d-33.43754339455698!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9662c5a4b6b6b6b7%3A0x7b7b7b7b7b7b7b7b!2sSantiago%20Centro%2C%20Regi%C3%B3n%20Metropolitana!5e0!3m2!1ses!2scl!4v1700000000000!5m2!1ses!2scl" 
              width="100%" 
              height="400" 
              style="border:0; border-radius: var(--lp-radius-lg);" 
              allowfullscreen="" 
              loading="lazy" 
              referrerpolicy="no-referrer-when-downgrade"
              title="UbicaciÃ³n del proyecto en Santiago Centro">
            </iframe>
            <div class="map-overlay">
              <a href="#contacto" class="map-link">
                <span>ğŸ“ Santiago Centro â€” Solicita informaciÃ³n</span>
                <span style="font-size: 10px; opacity: 0.8;">Abrir en Google Maps</span>
              </a>
            </div>
          </div>
        </div>
      </section>

      <!-- POR QUÃ‰ INVERTIR AHORA -->
      <section class="section" id="por-que-invertir">
        <div class="section-header">
          <h2 class="section-title">Â¿Por quÃ© invertir ahora?</h2>
          <p class="section-kicker">Contexto de mercado y oportunidad de inversiÃ³n en Santiago Centro</p>
          </div>

        <div class="why-invest-grid">
          <div class="why-invest-card">
            <div class="why-invest-icon">ğŸ“‰</div>
            <h3 class="why-invest-title">Tasas en baja</h3>
            <p class="why-invest-text">
              Las <strong>tasas de interÃ©s hipotecarias han comenzado a bajar</strong>, lo que mejora la accesibilidad al crÃ©dito y reduce el costo total del financiamiento.
            </p>
          </div>

          <div class="why-invest-card">
            <div class="why-invest-icon">ğŸ“ˆ</div>
            <h3 class="why-invest-title">Alta demanda</h3>
            <p class="why-invest-text">
              EstÃ¡s en una zona con <strong>alta demanda de arriendo y oferta moderada</strong>, lo que proyecta buena estabilidad de ocupaciÃ³n y valorizaciÃ³n futura.
            </p>
          </div>

          <div class="why-invest-card">
            <div class="why-invest-icon">ğŸŒ±</div>
            <h3 class="why-invest-title">Etapa verde</h3>
            <p class="why-invest-text">
              Este proyecto se encuentra en <strong>etapa verde</strong>: puedes pagar el pie en cuotas y capturar plusvalÃ­a desde la construcciÃ³n.
            </p>
          </div>
            </div>

        <div class="why-invest-highlights">
          <div class="highlight-pill">
            <span class="highlight-pill-icon">ğŸ“‰</span>
            <span>Baja gradual de tasas hipotecarias</span>
                  </div>
          <div class="highlight-pill">
            <span class="highlight-pill-icon">ğŸ“ˆ</span>
            <span>Alta demanda de arriendo en Santiago Centro</span>
                  </div>
          <div class="highlight-pill">
            <span class="highlight-pill-icon">ğŸŒ±</span>
            <span>Etapa verde: pie en cuotas</span>
                  </div>
          <div class="highlight-pill">
            <span class="highlight-pill-icon">ğŸš‡</span>
            <span>ProyecciÃ³n positiva por futura LÃ­nea 9</span>
          </div>
        </div>
      </section>

      <!-- PROCESO DE INVERSIÃ“N -->
      <section class="section" id="proceso">
        <div class="section-header">
          <h2 class="section-title">Proceso de inversiÃ³n</h2>
          <p class="section-kicker">AcompaÃ±amiento desde el diagnÃ³stico hasta la firma de promesa</p>
              </div>

        <div class="steps-grid">
          <article class="step-card">
            <div class="step-index">1</div>
            <div class="step-title">AnÃ¡lisis financiero</div>
            <p class="step-text">
              Revisamos tu documentaciÃ³n y diseÃ±amos una propuesta adaptada tanto a tu perfil de inversionista como a tu situaciÃ³n financiera actual.
            </p>
          </article>

          <article class="step-card">
            <div class="step-index">2</div>
            <div class="step-title">PreaprobaciÃ³n bancaria</div>
            <p class="step-text">
              Coordinamos con nuestros ejecutivos para obtener una o mÃ¡s preaprobaciones de crÃ©dito, dejando tu financiamiento encaminado antes de reservar.
            </p>
          </article>

          <article class="step-card">
            <div class="step-index">3</div>
            <div class="step-title">Reserva de la unidad</div>
            <p class="step-text">
              Realizas la reserva para asegurar la unidad seleccionada mientras ultimamos detalles de la promesa de compraventa.
            </p>
          </article>

          <article class="step-card">
            <div class="step-index">4</div>
            <div class="step-title">Firma de promesa</div>
            <p class="step-text">
              Firmas la promesa de compraventa, que fija precio, plazos y condiciones, entregÃ¡ndote seguridad jurÃ­dica antes de la escritura final.
            </p>
          </article>
            </div>
      </section>

      <!-- PREGUNTAS FRECUENTES -->
      <section class="section" id="faq">
        <div class="section-header">
          <h2 class="section-title">Preguntas frecuentes</h2>
          <p class="section-kicker">Resolvemos las dudas mÃ¡s comunes antes de invertir</p>
                  </div>

        <div class="faq-grid">
          <div class="faq-item">
            <div class="faq-q">
              <span class="faq-icon">ğŸ’°</span>
              <span>Â¿CÃ³mo se divide el pie 10%?</span>
                  </div>
            <div class="faq-a">El pie se divide en cuotas, permitiÃ©ndote entrar al proyecto con menor esfuerzo inicial. Detalle exacto segÃºn condiciones vigentes al momento de la reserva.</div>
                  </div>

          <div class="faq-item">
            <div class="faq-q">
              <span class="faq-icon">ğŸ“‹</span>
              <span>Â¿QuÃ© necesito para promesar?</span>
                </div>
            <div class="faq-a">Contar con una preaprobaciÃ³n bancaria vigente y cumplir con la documentaciÃ³n solicitada por la inmobiliaria y el banco.</div>
              </div>

          <div class="faq-item">
            <div class="faq-q">
              <span class="faq-icon">ğŸ“…</span>
              <span>Â¿CuÃ¡ndo se entrega el proyecto?</span>
                </div>
            <div class="faq-a">La entrega estimada es a mediados de 2028, sujeta al avance de la obra y permisos correspondientes.</div>
                </div>

          <div class="faq-item">
            <div class="faq-q">
              <span class="faq-icon">ğŸš—</span>
              <span>Â¿Hay estacionamientos y bodegas?</span>
                </div>
            <div class="faq-a">SÃ­, hay opciones de estacionamientos y bodegas sujetos a disponibilidad y valores vigentes al momento de la reserva.</div>
                </div>

          <div class="faq-item">
            <div class="faq-q">
              <span class="faq-icon">ğŸ</span>
              <span>Â¿QuÃ© incluye la promociÃ³n?</span>
            </div>
            <div class="faq-a">PromociÃ³n de lanzamiento con un 15% de descuento sobre el valor de lista, vÃ¡lida para unidades y plazos definidos por el desarrollador.</div>
                </div>

          <div class="faq-item">
            <div class="faq-q">
              <span class="faq-icon">ğŸ’³</span>
              <span>Â¿Hay gastos adicionales?</span>
                </div>
            <div class="faq-a">SÃ­, los habituales gastos operacionales, notariales y seguros al momento de la escrituraciÃ³n del crÃ©dito hipotecario.</div>
              </div>
        </div>
      </section>

      <!-- FORMULARIO / CALL TO ACTION -->
      <section class="section" id="contacto">
        <div class="section-header">
          <h2 class="section-title">Â¿Te interesa este proyecto?</h2>
          <p class="section-kicker">Recibe una propuesta personalizada sin compromiso</p>
                </div>

        <div style="text-align: center; padding: 2rem 0;">
          <p style="font-size: 1.125rem; color: var(--re-text-secondary); margin-bottom: 2rem; max-width: 600px; margin-left: auto; margin-right: auto;">
            Completa un breve formulario y nuestro equipo te enviarÃ¡ una propuesta ajustada a tu perfil financiero y necesidades.
          </p>
          <button onclick="openWizard(event)" class="btn btn-primary" style="font-size: 1.125rem; padding: 1rem 2.5rem;">
            <span>ğŸ“</span>
            <span>Quiero mi propuesta personalizada</span>
          </button>
        </div>
      </section>

      <!-- FORMULARIO / MULTISTEP WIZARD (OVERLAY) -->
        <div class="wizard-container">
          <form class="form wizard-form" action="/submit.php" method="post" id="wizard-form">
            <input type="hidden" name="cf-turnstile-response" id="ts-token" />
            
            <!-- Stepper Indicator -->
            <div class="wizard-stepper">
              <button type="button" class="wizard-close-btn" onclick="closeWizard()" aria-label="Cerrar formulario">
                âœ•
              </button>
              <div class="wizard-stepper-inner">
                <div class="step-indicator active" data-step="1">
                  <span class="step-number">1</span>
                </div>
                <div class="step-connector"></div>
                <div class="step-indicator" data-step="2">
                  <span class="step-number">2</span>
                </div>
              </div>
            </div>

            <!-- Step 1: InformaciÃ³n Personal -->
            <div id="step-1" class="step">
              <div class="wizard-step-content">
                <div class="wizard-step-header">
                  <h2 class="wizard-step-title">InformaciÃ³n personal</h2>
                  <p class="wizard-step-subtitle">Comencemos con tus datos bÃ¡sicos</p>
                </div>

        <div class="form-card">
                  <div class="field field-floating">
                    <input id="nombre" name="nombre" type="text" placeholder=" " required />
                    <label for="nombre">Nombre completo</label>
                  </div>

                  <div class="field field-floating">
                    <input id="rut" name="rut" type="text" placeholder=" " required />
                    <label for="rut">RUT</label>
                </div>

                  <div class="field field-floating">
                    <input id="telefono" name="telefono" type="tel" placeholder=" " required />
                    <label for="telefono">TelÃ©fono WhatsApp</label>
                </div>

                  <div class="field field-floating">
                    <input id="correo" name="correo" type="email" placeholder=" " required />
                    <label for="correo">Correo electrÃ³nico</label>
                  </div>
                </div>
              </div>
                  </div>

            <!-- Step 2: Perfil Financiero -->
            <div id="step-2" class="step">
              <div class="wizard-step-content">
                <div class="wizard-step-header">
                  <h2 class="wizard-step-title">Tu perfil financiero</h2>
                  <p class="wizard-step-subtitle">AyÃºdanos a conocerte mejor</p>
                </div>

                <div class="form-card">
                  <div class="question-group">
                    <h3 class="question-title">Â¿CuÃ¡l es tu objetivo con esta inversiÃ³n?</h3>
                    <div class="option-buttons" role="radiogroup" aria-label="Objetivo">
                      <label class="option-button" data-value="invertir">
                    <input type="radio" id="objetivo-invertir" name="objetivo" value="invertir" required />
                        <span>Invertir para renta</span>
                  </label>
                      <label class="option-button" data-value="vivir">
                    <input type="radio" id="objetivo-vivir" name="objetivo" value="vivir" required />
                        <span>Comprar para vivir</span>
                  </label>
                      <label class="option-button" data-value="no-se">
                    <input type="radio" id="objetivo-no-se" name="objetivo" value="no-se" required />
                        <span>AÃºn no lo tengo claro</span>
                  </label>
                </div>
                </div>

                  <div class="question-group">
                    <h3 class="question-title">Â¿CuÃ¡l es tu renta lÃ­quida mensual?</h3>
                    <p class="question-hint">Las entidades financieras solicitan una renta mÃ­nima desde $1.400.000 para crÃ©dito hipotecario.</p>
                    <div class="option-buttons" role="radiogroup" aria-label="Renta lÃ­quida">
                      <label class="option-button" data-value="renta-1">
                        <input type="radio" id="renta-1" name="renta-rango" value="1000001-1400000" required />
                        <span>Entre $1.000.001 - $1.400.000</span>
                </label>
                      <label class="option-button" data-value="renta-2">
                        <input type="radio" id="renta-2" name="renta-rango" value="1400001-1800000" required />
                        <span>Entre $1.400.001 - $1.800.000</span>
                </label>
                      <label class="option-button" data-value="renta-3">
                        <input type="radio" id="renta-3" name="renta-rango" value="1800001+" required />
                        <span>MÃ¡s de $1.800.001</span>
                      </label>
                    </div>
                </div>

                  <div class="question-group">
                    <h3 class="question-title">Â¿CuÃ¡l es tu capacidad de ahorro mensual aproximadamente?</h3>
                    <div class="option-buttons" role="radiogroup" aria-label="Capacidad de ahorro">
                      <label class="option-button" data-value="ahorro-0">
                        <input type="radio" id="ahorro-0" name="ahorro-mensual" value="0" required />
                        <span>No tengo capacidad de ahorro mensual</span>
                </label>
                      <label class="option-button" data-value="ahorro-1">
                        <input type="radio" id="ahorro-1" name="ahorro-mensual" value="100000-200000" required />
                        <span>Entre $100.000 - $200.000</span>
                  </label>
                      <label class="option-button" data-value="ahorro-2">
                        <input type="radio" id="ahorro-2" name="ahorro-mensual" value="200001-400000" required />
                        <span>Entre $200.001 - $400.000</span>
                  </label>
                      <label class="option-button" data-value="ahorro-3">
                        <input type="radio" id="ahorro-3" name="ahorro-mensual" value="400001+" required />
                        <span>MÃ¡s de $400.001</span>
                  </label>
                </div>
                </div>

                  <div class="question-group">
                    <h3 class="question-title">Â¿QuÃ© tipo de propiedad te interesa?</h3>
                    <div class="option-buttons" role="radiogroup" aria-label="Tipo de propiedad">
                      <label class="option-button" data-value="studio">
                    <input type="radio" id="tipo-studio" name="tipo" value="studio" required />
                        <span>Studio</span>
                </label>
                      <label class="option-button" data-value="1d">
                    <input type="radio" id="tipo-1d" name="tipo" value="1d" required />
                        <span>1 Dormitorio</span>
                  </label>
                      <label class="option-button" data-value="2d">
                    <input type="radio" id="tipo-2d" name="tipo" value="2d" required />
                        <span>2 Dormitorios</span>
                  </label>
                      <label class="option-button" data-value="todas">
                    <input type="radio" id="tipo-todas" name="tipo" value="todas" required />
                        <span>Todas las opciones</span>
                  </label>
              </div>
                </div>

                  <!-- TÃ©rminos y condiciones -->
            <div class="field-checkbox">
              <input id="terminos" name="terminos" type="checkbox" required />
              <label for="terminos">
                Acepto el tratamiento de mis datos y autorizo el contacto por WhatsApp y correo para recibir informaciÃ³n sobre este proyecto inmobiliario.
                  </label>
                </div>

                  <!-- Submit button -->
                  <button type="submit" id="form-submit-btn" class="wizard-btn wizard-btn-primary" style="margin-top: 1rem; width: 100%;">
                    <span class="btn-primary-icon">ğŸ“„</span>
                    <span>Recibir mi propuesta personalizada</span>
                  </button>
              
              <div class="turnstile-container" style="margin: 16px 0; display: flex; justify-content: center;">
                <div class="cf-turnstile" data-sitekey="0x4AAAAAAB_bjq2YOWp-yEXx" data-theme="auto" data-callback="onTurnstileSuccess"></div>
              </div>

                  <p class="text-xs text-gray-500 text-center mt-4">â° Oferta sujeta a disponibilidad de unidades y vigencia de la promociÃ³n de lanzamiento.</p>
                </div>
                </div>
                </div>

            <!-- Success Message (hidden by default) -->
            <div id="success-message" class="success-screen" style="display: none;">
              <div class="success-content">
                <div class="success-icon">âœ“</div>
                <h2 class="success-title">Â¡Gracias por completar!</h2>
                <p class="success-text">Te enviaremos la propuesta personalizada a tu correo electrÃ³nico en las prÃ³ximas horas.</p>
                <p class="success-subtext">Nuestro equipo se pondrÃ¡ en contacto contigo pronto.</p>
              </div>
            </div>

            <!-- Bottom CTA Zone -->
            <div class="wizard-cta">
              <div class="wizard-cta-inner">
                <button type="button" id="wizard-next-btn" class="wizard-btn wizard-btn-primary">
                  Siguiente
                </button>
                <button type="button" id="wizard-back-btn" class="wizard-btn wizard-btn-secondary hidden">
                  AtrÃ¡s
                </button>
              </div>
              </div>
            </form>
        </div>

      <!-- FOOTER -->
      <footer class="footer">
        <div>
          <img src="/images/logo_negro.png" alt="Select Capital" class="footer-logo footer-logo-light" style="height: 32px; margin-bottom: 12px;" />
          <img src="/images/logo_blanco.png" alt="Select Capital" class="footer-logo footer-logo-dark" style="height: 32px; margin-bottom: 12px; display: none;" />
          <p style="margin: 0 0 8px 0; font-size: 12px;">
            <strong>Select Capital</strong> Â· AsesorÃ­a Inmobiliaria<br />
            Av. Apoquindo 6410, Of. 1203, Las Condes
          </p>
              </div>
              <div>
          <div class="footer-contact">
            <a href="https://wa.me/56966013182?text=Hola,%20quiero%20informaciÃ³n%20sobre%20el%20proyecto%20en%20Santiago%20Centro" target="_blank" rel="noopener" class="contact-link">
              <span>ğŸ’¬</span>
              <span>WhatsApp</span>
            </a>
            <a href="mailto:contacto@selectcapital.cl" class="contact-link">
              <span>âœ‰ï¸</span>
              <span>contacto@selectcapital.cl</span>
            </a>
              </div>
          <p style="margin: 12px 0 0 0; font-size: 11px; color: var(--sc-text-tertiary, rgba(15, 23, 42, 0.5));">
            Promociones y precios en UF, sujetos a disponibilidad y modificaciones del plan de obra.
          </p>
            </div>
      </footer>
          </div>

    <!-- Sticky CTA Button (Mobile) -->
    <div class="sticky-cta" id="sticky-cta">
      <button type="button" class="sticky-cta-button" data-action="scroll-form">
        <span class="btn-primary-icon">ğŸ“„</span>
        <span>Quiero mi propuesta</span>
      </button>
    </div>

    <!-- Cloudflare Turnstile -->
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
    
    <script type="module" src="/lenguaje visual/theme/theme-toggle.min.js"></script>
    <script>
      // Turnstile callback
      window.onTurnstileSuccess = function(token) {
        const tokenInput = document.getElementById('ts-token');
        const submitBtn = document.getElementById('form-submit-btn');
        if (tokenInput) {
          tokenInput.value = token;
        }
        if (submitBtn) {
          submitBtn.disabled = false;
        }
      };

      // Update theme icon based on current theme
      // ============================================
      // WIZARD MULTISTEP LOGIC
      // ============================================
      let currentStep = 0;
      const totalSteps = 2;

      function goToStep(stepIndex) {
        if (stepIndex < 0 || stepIndex >= totalSteps) return;

        // Hide all steps
        document.querySelectorAll('.step').forEach((step, index) => {
          step.classList.remove('active');
          step.style.position = 'absolute';
          step.style.opacity = '0';
          step.style.pointerEvents = 'none';
          step.style.zIndex = '1';
        });

        // Show current step
        const currentStepEl = document.getElementById(`step-${stepIndex + 1}`);
        if (currentStepEl) {
          currentStepEl.style.position = 'relative';
          currentStepEl.style.pointerEvents = 'auto';
          currentStepEl.style.zIndex = '2';
          currentStepEl.style.display = 'flex';
          setTimeout(() => {
            currentStepEl.classList.add('active');
            currentStepEl.style.opacity = '1';
            
            // Scroll to top of wizard container to ensure proper centering
            const wizardContainer = document.querySelector('.wizard-container');
            if (wizardContainer) {
              wizardContainer.scrollTop = 0;
            }
          }, 50);
        }

        // Update stepper indicators
        document.querySelectorAll('.step-indicator').forEach((indicator, index) => {
          if (index <= stepIndex) {
            indicator.classList.add('active');
          } else {
            indicator.classList.remove('active');
          }
        });

        // Update step connectors
        document.querySelectorAll('.step-connector').forEach((connector, index) => {
          if (index < stepIndex) {
            connector.classList.add('active');
          } else {
            connector.classList.remove('active');
          }
        });

        // Update buttons
        const nextBtn = document.getElementById('wizard-next-btn');
        const backBtn = document.getElementById('wizard-back-btn');
        const submitBtn = document.getElementById('form-submit-btn');

        if (stepIndex === 0) {
          backBtn?.classList.add('hidden');
        } else {
          backBtn?.classList.remove('hidden');
        }

        if (stepIndex === totalSteps - 1) {
          // Last step (step 2): hide next button, show submit button
          nextBtn?.classList.add('hidden');
          // Submit button is inside step-2, it should be visible
          if (submitBtn) {
            submitBtn.style.display = 'flex';
          }
        } else {
          // First step: show next button, hide submit button
          nextBtn?.classList.remove('hidden');
          if (submitBtn) {
            submitBtn.style.display = 'none';
          }
        }

        currentStep = stepIndex;
      }

      function validateStep(stepIndex) {
        const stepEl = document.getElementById(`step-${stepIndex + 1}`);
        if (!stepEl) return false;

        const requiredFields = stepEl.querySelectorAll('input[required], select[required]');
        let isValid = true;

        requiredFields.forEach(field => {
          // Skip hidden fields (like turnstile token)
          if (field.type === 'hidden') return;

          // For radio buttons, check if at least one in the group is checked
          if (field.type === 'radio') {
            const groupName = field.name;
            const groupChecked = stepEl.querySelector(`input[name="${groupName}"]:checked`);
            if (!groupChecked) {
              isValid = false;
              // Highlight the option group
              const optionGroup = field.closest('.option-grid, .contact-options, .option-buttons');
              if (optionGroup) {
                optionGroup.style.border = '1px solid rgba(239, 68, 68, 0.5)';
                optionGroup.style.borderRadius = '0.5rem';
                optionGroup.style.padding = '0.5rem';
                setTimeout(() => {
                  optionGroup.style.border = '';
                  optionGroup.style.borderRadius = '';
                  optionGroup.style.padding = '';
                }, 2000);
              }
            }
          } else if (field.type === 'checkbox') {
            if (!field.checked) {
              isValid = false;
              field.style.borderColor = 'rgba(239, 68, 68, 0.5)';
              setTimeout(() => {
                field.style.borderColor = '';
              }, 2000);
            }
          } else {
            // Text inputs, email, tel, etc.
            if (!field.value.trim()) {
              isValid = false;
              field.style.borderColor = 'rgba(239, 68, 68, 0.5)';
              setTimeout(() => {
                field.style.borderColor = '';
              }, 2000);
            }
          }
        });

        return isValid;
      }

      // Open wizard function (global scope)
      function openWizard(e) {
        if (e) e.preventDefault();
        const wizardContainer = document.querySelector('.wizard-container');
        if (wizardContainer) {
          // Show wizard container
          wizardContainer.style.display = 'flex';
          wizardContainer.classList.add('active');
          document.body.style.overflow = 'hidden';
          
          // Reset to first step
          currentStep = 0;
          
          // Hide all steps first
          document.querySelectorAll('.step').forEach(step => {
            step.classList.remove('active');
            step.style.position = 'absolute';
            step.style.opacity = '0';
            step.style.pointerEvents = 'none';
          });
          
          // Show first step
          const firstStep = document.getElementById('step-1');
          if (firstStep) {
            firstStep.style.position = 'relative';
            firstStep.style.pointerEvents = 'auto';
            setTimeout(() => {
              firstStep.classList.add('active');
              firstStep.style.opacity = '1';
            }, 50);
          }
          
          // Update buttons and indicators
          goToStep(0);
          
          // Scroll to top
          window.scrollTo({ top: 0, behavior: 'smooth' });
        }
      }

      // Close wizard function (global scope)
      function closeWizard() {
        const wizardContainer = document.querySelector('.wizard-container');
        const successMessage = document.getElementById('success-message');
        
        if (wizardContainer) {
          wizardContainer.style.display = 'none';
          wizardContainer.classList.remove('active');
          document.body.style.overflow = '';
        }
        
        if (successMessage) {
          successMessage.style.display = 'none';
        }
      }

      // Scroll to form function
      function scrollToForm(e) {
        if (e) e.preventDefault();
        // Now opens wizard instead of scrolling
        openWizard(e);
      }

      // Initialize wizard
      document.addEventListener('DOMContentLoaded', () => {
        // Wizard navigation
        const nextBtn = document.getElementById('wizard-next-btn');
        const backBtn = document.getElementById('wizard-back-btn');

        if (nextBtn) {
          nextBtn.addEventListener('click', () => {
            if (validateStep(currentStep)) {
              goToStep(currentStep + 1);
            }
          });
        }

        if (backBtn) {
          backBtn.addEventListener('click', () => {
            goToStep(currentStep - 1);
          });
        }

        // Initialize wizard (hidden by default)
        const wizardContainer = document.querySelector('.wizard-container');
        if (wizardContainer) {
          // Hide all steps initially
          document.querySelectorAll('.step').forEach(step => {
            step.classList.remove('active');
            step.style.display = 'none';
          });
          // Hide submit button initially (it's only shown in step-2)
          const submitBtn = document.getElementById('form-submit-btn');
          if (submitBtn) {
            submitBtn.style.display = 'none';
          }
          // Prepare first step (but don't show wizard yet)
          const firstStep = document.getElementById('step-1');
          if (firstStep) {
            firstStep.style.display = 'flex';
            firstStep.classList.add('active');
          }
        }

        // Connect buttons to open wizard
        const allScrollFormBtns = document.querySelectorAll('[data-action="scroll-form"]');
        allScrollFormBtns.forEach((btn) => {
          btn.addEventListener('click', openWizard);
        });
      });

      document.addEventListener('DOMContentLoaded', () => {
        const themeIcon = document.querySelector('[data-theme-icon]');
        const logoLight = document.querySelector('.header-logo .logo-light');
        const logoDark = document.querySelector('.header-logo .logo-dark');
        const footerLogoLight = document.querySelector('.footer-logo-light');
        const footerLogoDark = document.querySelector('.footer-logo-dark');
        
        const updateTheme = () => {
          const currentTheme = document.documentElement.getAttribute('data-theme');
          if (themeIcon) {
            themeIcon.textContent = currentTheme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
          }
          // Update header logo visibility
          if (logoLight && logoDark) {
            if (currentTheme === 'dark') {
              logoLight.style.display = 'none';
              logoDark.style.display = 'block';
            } else {
              logoLight.style.display = 'block';
              logoDark.style.display = 'none';
            }
          }
          // Update footer logo visibility
          if (footerLogoLight && footerLogoDark) {
            if (currentTheme === 'dark') {
              footerLogoLight.style.display = 'none';
              footerLogoDark.style.display = 'block';
            } else {
              footerLogoLight.style.display = 'block';
              footerLogoDark.style.display = 'none';
            }
          }
        };
        
        // Initial update
        updateTheme();
        
        // Watch for theme changes
        const observer = new MutationObserver(() => {
          updateTheme();
        });
        
        observer.observe(document.documentElement, {
          attributes: true,
          attributeFilter: ['data-theme']
        });


        // Sticky CTA visibility control
        const stickyCta = document.getElementById('sticky-cta');
        const formSection = document.getElementById('contacto');
        
        if (stickyCta && formSection) {
          const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.1
          };
          
          const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
              if (entry.isIntersecting) {
                // Form is visible, hide sticky CTA
                stickyCta.classList.remove('is-visible');
              } else {
                // Form is not visible, show sticky CTA (only if scrolled past hero)
                const heroBottom = document.querySelector('.header')?.getBoundingClientRect().bottom || 0;
                if (window.scrollY > heroBottom + 100) {
                  stickyCta.classList.add('is-visible');
                } else {
                  stickyCta.classList.remove('is-visible');
                }
              }
            });
          }, observerOptions);
          
          observer.observe(formSection);
          
          // Also check on scroll
          let ticking = false;
          window.addEventListener('scroll', () => {
            if (!ticking) {
              window.requestAnimationFrame(() => {
                const heroBottom = document.querySelector('.header')?.getBoundingClientRect().bottom || 0;
                const formRect = formSection.getBoundingClientRect();
                const isFormVisible = formRect.top < window.innerHeight && formRect.bottom > 0;
                
                if (isFormVisible) {
                  stickyCta.classList.remove('is-visible');
                } else if (window.scrollY > heroBottom + 100) {
                  stickyCta.classList.add('is-visible');
                } else {
                  stickyCta.classList.remove('is-visible');
                }
                
                ticking = false;
              });
              ticking = true;
            }
          });
        }

        // ============================================
        // FORM FIELD NORMALIZATION FUNCTIONS
        // ============================================
        
        // Normalize RUT: Format to 12.345.678-9 and validate
        function normalizeRUT(value, cursorPosition) {
          if (!value) return { formatted: '', newCursorPos: 0 };
          
          cursorPosition = cursorPosition || 0;
          
          // Remove all non-alphanumeric except dots and dash
          let clean = value.replace(/[^0-9kK\.-]/g, '');
          
          // Count actual digits/K before cursor in original value
          const beforeCursor = value.substring(0, cursorPosition);
          const digitsBeforeCursor = (beforeCursor.match(/[0-9kK]/g) || []).length;
          
          // Split by dash to separate number from verifier digit
          const parts = clean.split('-');
          let number = parts[0]?.replace(/\./g, '') || '';
          let digit = parts[1] || '';
          
          // Auto-extract verifier digit when we have 8+ chars
          if (!digit && number.length >= 8) {
            const lastChar = number.slice(-1);
            if (lastChar.toLowerCase() === 'k' || /\d/.test(lastChar)) {
              digit = lastChar.toUpperCase();
              number = number.slice(0, -1);
            }
          }
          
          // Clean number (only digits)
            number = number.replace(/\D/g, '');
          
          // Format with dots: X.XXX.XXX
          let formatted = '';
          const length = number.length;
          
          for (let i = 0; i < length; i++) {
            // Add dot every 3 positions from the right
            if (i > 0 && (length - i) % 3 === 0) {
              formatted += '.';
            }
            formatted += number[i];
          }
          
          // Add dash and verifier digit if present and valid
          if (digit && number.length >= 7) {
            formatted += '-' + digit.toUpperCase();
          }
          
          // Calculate new cursor position
          let newCursorPos = 0;
          let digitsSeen = 0;
          
          for (let i = 0; i < formatted.length; i++) {
            if (/[0-9kK]/i.test(formatted[i])) {
              digitsSeen++;
              if (digitsSeen >= digitsBeforeCursor) {
                newCursorPos = i + 1;
                break;
              }
            }
          }
          
          // If cursor was at end, place at end of formatted string
          if (digitsBeforeCursor >= (number.length + (digit ? 1 : 0))) {
            newCursorPos = formatted.length;
          }
          
          return { formatted, newCursorPos };
        }
        
        // Validate RUT digit
        function validateRUT(rut) {
          if (!rut) return false;
          
          const clean = rut.replace(/\./g, '').replace(/-/g, '');
          if (clean.length < 8 || clean.length > 10) return false;
          
          const number = clean.slice(0, -1);
          const digit = clean.slice(-1).toUpperCase();
          
          let sum = 0;
          let multiplier = 2;
          
          for (let i = number.length - 1; i >= 0; i--) {
            sum += parseInt(number[i]) * multiplier;
            multiplier = multiplier === 7 ? 2 : multiplier + 1;
          }
          
          const remainder = sum % 11;
          const calculatedDigit = remainder < 2 ? remainder.toString() : (11 - remainder).toString();
          const expectedDigit = calculatedDigit === '11' ? '0' : calculatedDigit === '10' ? 'K' : calculatedDigit;
          
          return digit === expectedDigit;
        }
        
        // Normalize phone/WhatsApp: Format to +56 9 xxxx xxxx
        function normalizePhone(value, cursorPosition) {
          if (!value) return { formatted: '', newCursorPos: 0 };
          
          cursorPosition = cursorPosition || 0;
          
          // Remove all non-digits
          let clean = value.replace(/\D/g, '');
          
          // Count digits before cursor
          const beforeCursor = value.substring(0, cursorPosition);
          const digitsBeforeCursor = (beforeCursor.match(/\d/g) || []).length;
          
          // Remove country code if present (569)
          if (clean.startsWith('569')) {
            clean = clean.substring(2); // Keep the 9
          } else if (clean.startsWith('56')) {
            clean = clean.substring(2);
          }
          
          // Remove leading 0
          if (clean.startsWith('0')) {
            clean = clean.substring(1);
          }
          
          // Ensure it starts with 9 (Chilean mobile)
          if (clean.length > 0 && !clean.startsWith('9')) {
            clean = '9' + clean;
          }
          
          // Limit to 9 digits (9 + 8 digits)
          clean = clean.substring(0, 9);
          
          // Format: +56 9 xxxx xxxx
          let formatted = '';
          if (clean.length >= 1) {
            formatted = `+56 ${clean.charAt(0)}`;
            if (clean.length > 1) {
              formatted += ` ${clean.substring(1, 5)}`;
              if (clean.length > 5) {
                formatted += ` ${clean.substring(5, 9)}`;
              }
            }
          } else {
            formatted = '';
          }
          
          // Calculate cursor position
          let newCursorPos = 0;
          let digitsSeen = 0;
          
          for (let i = 0; i < formatted.length; i++) {
            if (/\d/.test(formatted[i])) {
              digitsSeen++;
              if (digitsSeen >= digitsBeforeCursor) {
                newCursorPos = i + 1;
                break;
              }
            }
          }
          
          // If cursor was at end
          if (digitsBeforeCursor >= clean.length) {
            newCursorPos = formatted.length;
          }
          
          return { formatted, newCursorPos };
        }
        
        // Normalize email: trim and lowercase
        function normalizeEmail(value) {
          if (!value) return '';
          return value.trim().toLowerCase();
        }
        
        // Normalize name: Proper capitalization
        function normalizeName(value) {
          if (!value) return '';
          
          return value
            .trim()
            .split(/\s+/)
            .map(word => {
              if (word.length === 0) return '';
              // Handle special prefixes (de, del, la, etc.)
              const lowerWords = ['de', 'del', 'la', 'las', 'los', 'el', 'y', 'e'];
              if (lowerWords.includes(word.toLowerCase())) {
                return word.toLowerCase();
              }
              // Capitalize first letter, lowercase rest
              return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();
            })
            .join(' ');
        }
        
        // Normalize number: Remove formatting, keep only digits
        function normalizeNumber(value) {
          if (!value) return '';
          // Remove all non-digits
          return value.replace(/[^\d]/g, '');
        }
        
        // Format number with thousands separator (Chilean format)
        function formatNumber(value, cursorPosition) {
          if (!value) return { formatted: '', newCursorPos: 0 };
          
          cursorPosition = cursorPosition || 0;
          
          // Count digits before cursor
          const beforeCursor = value.substring(0, cursorPosition);
          const digitsBeforeCursor = (beforeCursor.match(/\d/g) || []).length;
          
          const clean = normalizeNumber(value);
          if (!clean) return { formatted: '', newCursorPos: 0 };
          
          // Format with thousand separators (dots)
          const formatted = clean.replace(/\B(?=(\d{3})+(?!\d))/g, '.');
          
          // Calculate new cursor position
          let newCursorPos = 0;
          let digitsSeen = 0;
          
          for (let i = 0; i < formatted.length; i++) {
            if (/\d/.test(formatted[i])) {
              digitsSeen++;
              if (digitsSeen >= digitsBeforeCursor) {
                newCursorPos = i + 1;
                break;
              }
            }
          }
          
          // If cursor was at end
          if (digitsBeforeCursor >= clean.length) {
            newCursorPos = formatted.length;
          }
          
          return { formatted, newCursorPos };
        }
        
        // ============================================
        // APPLY NORMALIZATION TO FORM FIELDS
        // ============================================
        
        const form = document.querySelector('.form');
        if (form) {
          // RUT normalization
          const rutInput = form.querySelector('#rut');
          if (rutInput) {
            rutInput.addEventListener('input', (e) => {
                const cursorPos = e.target.selectionStart;
              const result = normalizeRUT(e.target.value, cursorPos);
              
              if (result.formatted !== e.target.value) {
                e.target.value = result.formatted;
                // Set cursor to calculated position
                const newPos = Math.max(0, Math.min(result.newCursorPos, result.formatted.length));
                e.target.setSelectionRange(newPos, newPos);
              }
            });
            
            rutInput.addEventListener('blur', (e) => {
              const result = normalizeRUT(e.target.value, e.target.selectionStart);
              const normalized = result.formatted;
              
              if (normalized && !validateRUT(normalized)) {
                e.target.style.borderColor = 'rgba(248, 113, 113, 0.5)';
              } else {
                e.target.style.borderColor = '';
              }
              e.target.value = normalized;
            });
          }
          
          // Phone normalization
          const phoneInput = form.querySelector('#telefono');
          if (phoneInput) {
            phoneInput.addEventListener('input', (e) => {
                const cursorPos = e.target.selectionStart;
              const result = normalizePhone(e.target.value, cursorPos);
              
              if (result.formatted !== e.target.value) {
                e.target.value = result.formatted;
                const newPos = Math.max(0, Math.min(result.newCursorPos, result.formatted.length));
                e.target.setSelectionRange(newPos, newPos);
              }
            });
            
            phoneInput.addEventListener('blur', (e) => {
              const result = normalizePhone(e.target.value, e.target.selectionStart);
              e.target.value = result.formatted;
            });
          }
          
          // Email normalization
          const emailInput = form.querySelector('#correo');
          if (emailInput) {
            emailInput.addEventListener('blur', (e) => {
              e.target.value = normalizeEmail(e.target.value);
            });
          }
          
          // Name normalization
          const nameInput = form.querySelector('#nombre');
          if (nameInput) {
            nameInput.addEventListener('blur', (e) => {
              e.target.value = normalizeName(e.target.value);
            });
          }
          
          // Number formatting for renta
          const rentaInput = form.querySelector('#renta');
          if (rentaInput) {
            rentaInput.addEventListener('input', (e) => {
                  const cursorPos = e.target.selectionStart;
              const result = formatNumber(e.target.value, cursorPos);
              
              if (result.formatted !== e.target.value) {
                e.target.value = result.formatted;
                const newPos = Math.max(0, Math.min(result.newCursorPos, result.formatted.length));
                  e.target.setSelectionRange(newPos, newPos);
              }
            });
          }
          
          // Ahorro field (allow text like "No tengo")
          const ahorroInput = form.querySelector('#ahorro');
          if (ahorroInput) {
            ahorroInput.addEventListener('input', (e) => {
              const value = e.target.value;
              // If it's not "no tengo" or similar, format as number
              if (!/no\s+tengo/i.test(value) && /\d/.test(value)) {
                    const cursorPos = e.target.selectionStart;
                const result = formatNumber(value, cursorPos);
                
                if (result.formatted !== value) {
                  e.target.value = result.formatted;
                  const newPos = Math.max(0, Math.min(result.newCursorPos, result.formatted.length));
                    e.target.setSelectionRange(newPos, newPos);
                }
              }
            });
          }
        }
        
        // Form validation and submission
        const submitBtn = document.getElementById('form-submit-btn');
        
        if (form && submitBtn) {
          form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const tokenInput = document.getElementById('ts-token');
            if (!tokenInput || !tokenInput.value) {
              showFormMessage('Por favor, completa la verificaciÃ³n de seguridad antes de enviar.', 'error');
              return false;
            }

            // Normalize all fields before validation
            const rutInput = form.querySelector('#rut');
            const telefonoInput = form.querySelector('#telefono');
            const correoInput = form.querySelector('#correo');
            const nombreInput = form.querySelector('#nombre');
            const rentaInput = form.querySelector('#renta');
            const ahorroInput = form.querySelector('#ahorro');
            
            // Normalize RUT
            if (rutInput) {
              const result = normalizeRUT(rutInput.value, rutInput.selectionStart);
              const normalizedRUT = result.formatted;
              rutInput.value = normalizedRUT;
              
              if (normalizedRUT && !validateRUT(normalizedRUT)) {
                showFormMessage('Por favor, ingresa un RUT vÃ¡lido. El dÃ­gito verificador no es correcto.', 'error');
                rutInput.focus();
                return false;
              }
              
              if (normalizedRUT) {
                const cleanRut = normalizedRUT.replace(/\./g, '').replace(/-/g, '');
                if (cleanRut.length < 8 || cleanRut.length > 10) {
                  showFormMessage('Por favor, ingresa un RUT vÃ¡lido en formato: 12.345.678-9', 'error');
                  rutInput.focus();
                  return false;
                }
              }
            }
            
            // Normalize phone
            if (telefonoInput) {
              const normalizedPhone = normalizePhone(telefonoInput.value);
              telefonoInput.value = normalizedPhone;
              
              const whatsappPattern = /^\+56\s9\s\d{4}\s\d{4}$/;
              if (normalizedPhone && !whatsappPattern.test(normalizedPhone)) {
                showFormMessage('Por favor, ingresa un nÃºmero de WhatsApp vÃ¡lido en formato: +56 9 xxxx xxxx', 'error');
                telefonoInput.focus();
                return false;
              }
            }
            
            // Normalize email
            if (correoInput) {
              correoInput.value = normalizeEmail(correoInput.value);
            }
            
            // Normalize name
            if (nombreInput) {
              nombreInput.value = normalizeName(nombreInput.value);
            }
            
            // Normalize numbers (remove formatting for backend)
            if (rentaInput) {
              rentaInput.dataset.originalValue = rentaInput.value; // Store formatted for display
            }
            
            if (ahorroInput) {
              const ahorroValue = ahorroInput.value;
              if (!/no\s+tengo/i.test(ahorroValue) && /\d/.test(ahorroValue)) {
                ahorroInput.dataset.originalValue = ahorroValue; // Store formatted
              }
            }

            // Disable button and show loading state
            submitBtn.disabled = true;
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<span class="btn-primary-icon">â³</span><span>Enviando...</span>';
            submitBtn.style.opacity = '0.7';
            submitBtn.style.cursor = 'not-allowed';

            // Remove any existing messages
            removeFormMessages();

            try {
              // Create FormData and map fields to backend expected format
              const formData = new FormData();
              
              // Map form fields to backend expected fields (using normalized values)
              formData.append('nombre', form.querySelector('#nombre')?.value || '');
              formData.append('rut', form.querySelector('#rut')?.value || '');
              formData.append('email', form.querySelector('#correo')?.value || '');
              formData.append('whatsapp', form.querySelector('#telefono')?.value || '');
              // Get objetivo from radio button
              const objetivoRadio = form.querySelector('input[name="objetivo"]:checked');
              formData.append('objetivo', objetivoRadio?.value || '');
              formData.append('tipo_ingreso', 'dependiente'); // Default value (form doesn't have this field)
              formData.append('tipo_contrato', ''); // Optional field (not used in this form)
              
              // Handle renta - check for new radio buttons first, then fallback to input
              const rentaRangoRadio = form.querySelector('input[name="renta-rango"]:checked');
              let rentaValue = '';
              if (rentaRangoRadio) {
                rentaValue = rentaRangoRadio.value;
                // Map range to approximate value for backend
                if (rentaValue === '1000001-1400000') {
                  formData.append('renta_liquida', '1200000');
                } else if (rentaValue === '1400001-1800000') {
                  formData.append('renta_liquida', '1600000');
                } else if (rentaValue === '1800001+') {
                  formData.append('renta_liquida', '2000000');
                } else {
                  formData.append('renta_liquida', '0');
                }
              } else {
                // Fallback to old input field
                const rentaInput = form.querySelector('#renta');
                rentaValue = rentaInput?.value || '';
                formData.append('renta_liquida', normalizeNumber(rentaValue) || '0');
              }
              
              // Handle ahorro mensual - check for new radio buttons first
              const ahorroMensualRadio = form.querySelector('input[name="ahorro-mensual"]:checked');
              let capacidadAhorro = '0';
              let tieneAhorro = 'si';
              let montoAhorro = '0';
              
              if (ahorroMensualRadio) {
                const ahorroValue = ahorroMensualRadio.value;
                if (ahorroValue === '0') {
                  tieneAhorro = 'no';
                  capacidadAhorro = '0';
                  montoAhorro = '0';
                } else if (ahorroValue === '100000-200000') {
                  capacidadAhorro = '150000';
                  montoAhorro = '150000';
                } else if (ahorroValue === '200001-400000') {
                  capacidadAhorro = '300000';
                  montoAhorro = '300000';
                } else if (ahorroValue === '400001+') {
                  capacidadAhorro = '500000';
                  montoAhorro = '500000';
                }
              } else {
                // Fallback to old input field
                const ahorroInput = form.querySelector('#ahorro');
                const ahorroValue = ahorroInput?.value || '';
                tieneAhorro = /no\s+tengo/i.test(ahorroValue) ? 'no' : 'si';
                if (tieneAhorro === 'si' && /\d/.test(ahorroValue)) {
                  montoAhorro = normalizeNumber(ahorroValue) || '0';
                  capacidadAhorro = montoAhorro;
                }
              }
              
              formData.append('tiene_ahorro', tieneAhorro);
              formData.append('monto_ahorro', montoAhorro);
              formData.append('capacidad_ahorro_mensual', capacidadAhorro);
              
              formData.append('comunas_interes', 'Santiago Centro'); // Project location
              // Default canal preferido to whatsapp (removed from form)
              formData.append('canal_preferido', 'whatsapp');
              
              // Get tipo de propiedad from radio button
              const tipoRadio = form.querySelector('input[name="tipo"]:checked');
              const tipoValue = tipoRadio?.value || '';
              
              // Add tipo as comentarios for backend reference
              if (tipoValue) {
                const tipoLabels = {
                  'studio': 'Studio',
                  '1d': '1 Dormitorio',
                  '2d': '2 Dormitorios',
                  'todas': 'Todas las opciones'
                };
                const tipoLabel = tipoLabels[tipoValue] || tipoValue;
                formData.append('comentarios', `Tipo de propiedad de interÃ©s: ${tipoLabel}`);
              } else {
                formData.append('comentarios', '');
              }
              
              formData.append('tipo_ingreso_independiente', ''); // Not used in this form
              formData.append('franja_preferida', 'flexible'); // Default value (form doesn't have this field)
              formData.append('consentimiento_privacidad', form.querySelector('#terminos')?.checked ? 'si' : 'no');
              formData.append('consentimiento_contacto', form.querySelector('#terminos')?.checked ? 'si' : 'no');
              
              // Add Turnstile token
              formData.append('cf-turnstile-response', tokenInput.value);
              
              // Honeypot field (empty)
              formData.append('honey', '');
              
              // Add UTM parameters from URL if present
              const urlParams = new URLSearchParams(window.location.search);
              formData.append('utm_source', urlParams.get('utm_source') || '');
              formData.append('utm_medium', urlParams.get('utm_medium') || '');
              formData.append('utm_campaign', urlParams.get('utm_campaign') || '');
              formData.append('gclid', urlParams.get('gclid') || '');
              formData.append('fbclid', urlParams.get('fbclid') || '');
              formData.append('ttclid', urlParams.get('ttclid') || '');
              
              // Submit form
              const response = await fetch('/submit.php', {
                method: 'POST',
                body: formData
              });

              const result = await response.json();

              if (result.ok) {
                // Success - show success message screen
                const wizardContainer = document.querySelector('.wizard-container');
                const successMessage = document.getElementById('success-message');
                
                if (wizardContainer && successMessage) {
                  wizardContainer.style.display = 'none';
                  successMessage.style.display = 'flex';
                  document.body.style.overflow = 'hidden';
                }
                
                form.reset();
                window.turnstile?.reset();
              } else {
                throw new Error(result.message || 'Error al enviar el formulario');
              }
            } catch (error) {
              // Log error in development only
              if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1' || window.location.hostname.includes('dev.')) {
                console.error('Form submission error:', error);
              }
              showFormMessage(
                error.message || 'Hubo un problema al enviar tu solicitud. Por favor intenta nuevamente.',
                'error'
              );
              
              // Re-enable button
              submitBtn.disabled = false;
              submitBtn.innerHTML = originalText;
              submitBtn.style.opacity = '1';
              submitBtn.style.cursor = 'pointer';
            }
          });
        }

        // Helper functions for form messages
        function showFormMessage(message, type) {
          removeFormMessages();
          
          const messageEl = document.createElement('div');
          messageEl.className = `form-message ${type}`;
          messageEl.innerHTML = `
            <strong>${type === 'success' ? 'âœ“' : 'âš '}</strong>
            <span>${message}</span>
          `;
          messageEl.style.cssText = `
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 14px 18px;
            border-radius: 12px;
            margin: 16px 0;
            font-size: 14px;
            line-height: 1.5;
            ${type === 'success' 
              ? 'background: rgba(34, 197, 94, 0.1); border: 1.5px solid rgba(34, 197, 94, 0.3); color: #16a34a;' 
              : 'background: rgba(248, 113, 113, 0.1); border: 1.5px solid rgba(248, 113, 113, 0.3); color: #dc2626;'
            }
          `;
          
          const formFooter = document.querySelector('.form-footer');
          if (formFooter) {
            formFooter.insertBefore(messageEl, formFooter.firstChild);
          }
        }

        function removeFormMessages() {
          document.querySelectorAll('.form-message').forEach(el => el.remove());
        }

        // ============================================
        // LIGHTBOX / MODAL FOR TYPOLOGY IMAGES
        // ============================================
        const lightboxModal = document.createElement('div');
        lightboxModal.className = 'lightbox-modal';
        lightboxModal.innerHTML = `
          <div class="lightbox-backdrop"></div>
          <div class="lightbox-content">
            <button class="lightbox-close" aria-label="Cerrar" type="button">
              <span>Ã—</span>
        </button>
            <div class="lightbox-image-wrapper">
              <img class="lightbox-image" src="" alt="" />
      </div>
            <div class="lightbox-title"></div>
          </div>
        `;
        document.body.appendChild(lightboxModal);

        const lightboxBackdrop = lightboxModal.querySelector('.lightbox-backdrop');
        const lightboxClose = lightboxModal.querySelector('.lightbox-close');
        const lightboxImage = lightboxModal.querySelector('.lightbox-image');
        const lightboxTitle = lightboxModal.querySelector('.lightbox-title');

        function openLightbox(imageSrc, title) {
          lightboxImage.src = imageSrc;
          lightboxImage.alt = title;
          lightboxTitle.textContent = title;
          lightboxModal.classList.add('is-open');
          document.body.style.overflow = 'hidden';
        }

        function closeLightbox() {
          lightboxModal.classList.remove('is-open');
          document.body.style.overflow = '';
        }

        // Event listeners for lightbox
        document.querySelectorAll('[data-lightbox="true"]').forEach(wrapper => {
          wrapper.style.cursor = 'pointer';
          wrapper.addEventListener('click', (e) => {
            e.preventDefault();
            const imageSrc = wrapper.getAttribute('data-image');
            const title = wrapper.getAttribute('data-title') || '';
            openLightbox(imageSrc, title);
          });
        });

        // Close on backdrop click
        lightboxBackdrop.addEventListener('click', closeLightbox);

        // Close on close button click
        lightboxClose.addEventListener('click', closeLightbox);

        // Close on Escape key
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && lightboxModal.classList.contains('is-open')) {
            closeLightbox();
          }
        });
      });

      // Sticky Navigation
      const stickyNav = document.getElementById('sticky-nav');
      const mainThemeToggle = document.querySelector('.theme-toggle[data-theme-toggle]');
      const mainThemeIcon = document.querySelector('[data-theme-icon]');

      // Show/hide sticky nav on scroll
      let lastScroll = 0;
      window.addEventListener('scroll', () => {
        const currentScroll = window.pageYOffset;
        
        if (currentScroll > 200) {
          stickyNav.classList.add('is-visible');
        } else {
          stickyNav.classList.remove('is-visible');
        }
        
        lastScroll = currentScroll;
      });

      // Sync theme icon when theme changes
      const syncThemeIcon = () => {
        // Read theme from documentElement (html tag), not body
        const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
        const icon = currentTheme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
        if (mainThemeIcon) mainThemeIcon.textContent = icon;
      };

      // Observer for theme changes - observe documentElement, not body
      const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
          if (mutation.attributeName === 'data-theme') {
            syncThemeIcon();
          }
        });
      });

      observer.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['data-theme']
      });


      // Smooth scroll for sticky nav links
      document.querySelectorAll('.sticky-nav-links a').forEach(link => {
        link.addEventListener('click', (e) => {
          e.preventDefault();
          const targetId = link.getAttribute('href');
          const targetElement = document.querySelector(targetId);
          
          if (targetElement) {
            const offsetTop = targetElement.getBoundingClientRect().top + window.pageYOffset - 100;
            window.scrollTo({
              top: offsetTop,
              behavior: 'smooth'
            });
          }
        });
      });

        // Initialize theme icon
        syncThemeIcon();

        // Option Cards Interaction Handler (legacy)
        document.querySelectorAll('.option-card').forEach(card => {
          const radio = card.querySelector('input[type="radio"]');
          
          // Update card appearance when radio is checked/unchecked
          radio.addEventListener('change', () => {
            // Remove selected class from all cards in the same group
            const group = card.closest('.option-grid, .option-cards, .contact-options');
            if (group) {
              group.querySelectorAll('.option-card').forEach(c => {
                c.classList.remove('selected');
              });
            }
            
            // Add selected class to checked card
            if (radio.checked) {
              card.classList.add('selected');
            }
          });
          
          // Initialize selected state
          if (radio.checked) {
            card.classList.add('selected');
          }
        });

        // Option Buttons Interaction Handler (new Capitalizarme style)
        document.querySelectorAll('.option-button').forEach(button => {
          const radio = button.querySelector('input[type="radio"]');
          
          // Update button appearance when radio is checked/unchecked
          radio.addEventListener('change', () => {
            // Remove selected class from all buttons in the same group
            const group = button.closest('.option-buttons');
            if (group) {
              group.querySelectorAll('.option-button').forEach(b => {
                b.classList.remove('selected');
              });
            }
            
            // Add selected class to checked button
            if (radio.checked) {
              button.classList.add('selected');
            }
          });
          
          // Initialize selected state
          if (radio.checked) {
            button.classList.add('selected');
          }
        });
    </script>
  </body>
</html>

